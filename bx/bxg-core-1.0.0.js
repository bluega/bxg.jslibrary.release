"BXG.LICENSE.ID=0000_0000_0000";"Copyright â“’ 2009-2012 BLUEGA Inc. All rights reserved.";window.bxg={c:{},g:{},objectMgrs:[],levels:{},$7L:{},$6c:{},$9Y:{$6b:5000,$EF:20},$Hp:true};bxg.$E7=1;bxg.$E8=2;bxg.$6a=function(c,b,a){return function(){return c.apply(b,a)}};bxg.init=function(h,d){if(bx.UX.$DF.debug){bxg.$6j=true;bxg.Trace.level(bxg.Trace.DEBUG)}if(bxg.world){bxg.Trace.log("BXG","warning","bxg.init() was already executed.","bxg.init")}if(!h){bxg.Trace.log("BXG","errorParameter","playground="+h,"bxg.init");return}d=d||{};if(h&&(""+h).indexOf("HTML")!=-1&&(""+h).indexOf("Element")!=-1){bxg.world=h;bxg.playGround=h;bxg.area=bx.HCL.getElementRect(h);if(bxg.$Hp){bxg.geo=bxg.area}}else{if(d.world){bxg.world=bx.UX.$52.tagVP.$TAG("div",{id:"bxg$SYS_world"},{position:"relative",left:d.world.x+"px",top:d.world.y+"px",width:d.world.w+"px",height:d.world.h+"px"})}else{bxg.world=bx.UX.$52.tagVP.$TAG("div",{id:"bxg$SYS_world"},{position:"relative",left:"0px",top:"0px",width:bx.UX.width+"px",height:bx.UX.height+"px"})}bxg.playGround=bxg.world.$TAG("div",{id:"bxg$SYS_playground"},{overflow:"hidden",position:"relative",left:h.x+"px",top:h.y+"px",width:h.w+"px",height:h.h+"px"});bxg.playGround.style.display="block";bxg.area={};bxg.area.x=h.x;bxg.area.y=h.y;bxg.area.w=h.w;bxg.area.h=h.h;if(bxg.$Hp){bxg.geo=bxg.area}}function g(i){if(!i){i=window.event}bx.Event.preventDefault(i)}bx.Event.add(bxg.world,"touchstart",g,false);bx.Event.add(bxg.world,"touchend",g,false);bx.Event.add(bxg.world,"touchcancel",g,false);bx.Event.add(bxg.world,"touchmove",g,false);function c(){window.scrollTo(0,0)}bx.Event.add(window,"scroll",c,false);if(d.align&&d.align.x=="center"){if(bxg.area.w<bx.UX.width){bxg.area.x=Math.round((bx.UX.width-bxg.area.w)/2);bxg.playGround.style.left=bxg.area.x+"px"}}if(d.align&&d.align.y=="center"){if(bxg.area.h<bx.UX.height){bxg.area.y=Math.round((bx.UX.height-bxg.area.h)/2);bxg.playGround.style.top=bxg.area.y+"px"}}if(d.renderer=="canvas"){bxg.$9I=bxg.$E8}else{if(d.renderer=="DOMcanvas"){bxg.$9I=bxg.$E8|bxg.$E7}else{if(d.renderer!="DOM"){bxg.Trace.log("BXG","errorParameter","Invalid options.renderer="+d.renderer,"bxg.init")}bxg.$9I=bxg.$E7}}if(bxg.$9I&bxg.$E8){if(!bx.HCL.DV.supportCanvas()){bxg.$9I=bxg.$E7;bxg.Trace.log("BXG","debug","Rendering mode changed to 'tag' mode, because WebCore doesn't support HTMLCanvas.","bxg.init")}}if(bxg.$9I&bxg.$E7){if(!bxg.$EA){bxg.Trace.log("BXG","unknownClass","DOM Renderer","bxg.init")}bxg.$E9=bxg.$EA}else{if(!bxg.$EB){bxg.Trace.log("BXG","unknownClass","Canvas Renderer","bxg.init")}bxg.$E9=bxg.$EB}if(bxg.$E9){bxg.$E9.$EC({$8p:bxg.playGround,$GF:bxg.area})}bxg.$C9=d.rootURI;if(d&&d.execEnv=="editor"){bxg.$B1=true}if(location.protocol=="file:"||location.protocol=="widget:"){bxg.$CA="local"}if(bx.Loader.$6d){bxg.$CA="bxg"}if(d&&d.execEnv){bxg.$CA=d.execEnv}bxg.imageLoader=new bxg.CImageLoader();bxg.images=bxg.imageLoader.$HO();bxg.game=new bxg.CGameLoop();bxg.$DL={};function a(i){if(!i){i=window.event}if(!bx.Event.isLeftButton(i)){return false}if(i.type=="touchstart"||i.type=="mousedown"){bx.Event.mouseDrag(bxg.world,i,e,f)}if(i.type!="mouseup"||i.type!="touchend"||i.type!="touchcancel"){bxg.$DM(i)}}function e(){}function f(i,m,l,n,k,p,o,j,q){bxg.$DM(q)}function b(i){if(i.bx$Event){switch(i.bx$Event.action){case"onPause":case"onStop":if(bxg.game){bxg.game.$CB()}break;case"onResume":if(bxg.game){bxg.game.$CC()}break}}}if(bx.HCL.DV.hasTouchEvent()){bx.Event.add(bxg.world,"touchstart",a,false);bx.Event.add(bxg.world,"touchend",a,false);bx.Event.add(bxg.world,"touchcancel",a,false);bx.Event.add(bxg.world,"touchmove",a,false)}else{bx.Event.add(bxg.world,"mousedown",a,false);bx.Event.add(bxg.world,"mouseup",a,false);bx.Event.add(bxg.world,"mousemove",a,false)}bx.Event.add(bxg.world,"bx_activity_state",b,true);bxg.buffer=document.body.$TAG("div",{id:"bxg$SYS_buffer"},{display:"none"});bxg.TransitionTag=new bx.CTransition();bxg.ObjectFactory.$7C();return};bxg.load=function(a){if(window.onBxRun){if(bxg.$Hp){bx.Loader.load()}else{bxg.Trace.log("BXG","error","bxg.onGame() should be implemented to run game instead onBxRun().","bxg.load")}}else{if(!bxg.onGame){bxg.Trace.log("BXG","error","bxg.onGame() should be implemented to run game.","bxg.load")}else{function b(){bx.UX.init(a)}bx.Loader.load({onInit:b,onRun:bxg.onGame})}}};bxg.EVENT_NONE=0;bxg.EVENT_POINTER_START=1;bxg.EVENT_POINTER_MOVE=2;bxg.EVENT_POINTER_END=4;bxg.$DM=function(a){bxg.$DM.$DN=0;if(bxg.game&&(bxg.game.$66==1||bxg.game.$66==2)){for(bxg.$DM.$BY=0;bxg.$DM.$BY<bxg.game.$6e.length;bxg.$DM.$BY++){if(!bxg.game.$6e[bxg.$DM.$BY].$79||!bxg.game.$6e[bxg.$DM.$BY].$79.onSysEvent){continue}if(bxg.game.$6e[bxg.$DM.$BY].$79.onSysEvent.listenEvents===undefined){bxg.game.$6e[bxg.$DM.$BY].$79.onSysEvent.listenEvents=bxg.EVENT_POINTER_START|bxg.EVENT_POINTER_MOVE|bxg.EVENT_POINTER_END}if(!bxg.$DM.$DN){bxg.$DM.$DN=1;switch(a.type){case"touchstart":bxg.$DM.$DN=2;case"mousedown":bxg.$DL.type=bxg.EVENT_POINTER_START;break;case"touchmove":bxg.$DM.$DN=2;case"mousemove":bxg.$DL.type=bxg.EVENT_POINTER_MOVE;break;case"touchend":case"touchcancel":bxg.$DM.$DN=2;case"mouseup":bxg.$DL.type=bxg.EVENT_POINTER_END;break;default:return}if(bxg.$DM.$DN==2){if(a.targetTouches.length){bxg.$DL.scrX=a.targetTouches[0].clientX-bx.HCL.$0C(bxg.world);bxg.$DL.scrY=a.targetTouches[0].clientY-bx.HCL.$0D(bxg.world)}}else{bxg.$DL.scrX=a.clientX-bx.HCL.$0C(bxg.world);bxg.$DL.scrY=a.clientY-bx.HCL.$0D(bxg.world)}bxg.$DL.gameX=bxg.$DL.scrX-bxg.area.x;bxg.$DL.gameY=bxg.$DL.scrY-bxg.area.y;bxg.$DL.event=a}if((bxg.$DL.gameX>=0&&bxg.$DL.gameX<bxg.area.w)&&(bxg.$DL.gameY>=0&&bxg.$DL.gameY<bxg.area.h)){bxg.$DL.playGround=true}else{bxg.$DL.playGround=false}if(bxg.game.$6e[bxg.$DM.$BY].$79.onSysEvent.listenEvents&bxg.$DL.type){bxg.game.$6e[bxg.$DM.$BY].$79.onSysEvent(bxg.game.$6e[bxg.$DM.$BY],bxg.$DL)}}}};bxg.resize=function(a,b){if(!bxg.playGround){return}if(b){bxg.world.$CSS({left:b.x+"px",top:b.y+"px",width:b.w+"px",height:b.h+"px"})}bxg.playGround.$CSS({left:a.x+"px",top:a.y+"px",width:a.w+"px",height:a.h+"px"});bxg.area.x=a.x;bxg.area.y=a.y;bxg.area.w=a.w;bxg.area.h=a.h};bxg.shake=function(c,d,e,b){if(!bxg.game){return}if(!c||!d||!e){return}if(bxg.$7N){return}function a(){if(c<0){bxg.playGround.style.left=bxg.area.x+"px";bxg.playGround.style.top=bxg.area.y+"px";bxg.game.clearTimer(bxg.$7N);bxg.$7N=null}else{if(!b||b=="d"||b=="h"){bxg.playGround.style.left=(bxg.area.x+e*(c%2==0?-1:1))+"px"}if(!b||b=="d"||b=="v"){bxg.playGround.style.top=(bxg.area.y+e*(c%2==0?-1:1))+"px"}c--}}bxg.$7N=bxg.game.setTimer({callback:a,time:d})};bxg.random=function(a){if(a){bxg.random.$ED=a+12378757||12378757}bxg.random.$ED=parseInt(bxg.random.$ED*bxg.random.$ED/100)%100000;return bxg.random.$ED/100001};bxg.random.$ED=12378757;bxg.getZindexTop=function(a){if(a!==undefined){return(a+1)*bxg.$9Y.$6b*bxg.$9Y.$EF}else{if(bxg.game){a=0;for(var b=0;b<bxg.game.$6e.length;b++){if(a<bx.$checkNaN(bxg.game.$6e[b].$DF.zIndex)){a=bx.$checkNaN(bxg.game.$6e[b].$DF.zIndex)}}return a+bxg.$9Y.$6b*bxg.$9Y.$EF}else{return 0}}};bxg.CImageLoader=function(b,a){if(bx.inClassing){return}this.$7O=b||{};this.$6V=a;this.$6W=0;this.$9L=0;this.$6X=0;return this};bxg.CImageLoader.prototype.$HO=function(){return this.$7O};bxg.CImageLoader.prototype.load=function(f,l){function b(n,q,o){var p;var i="000000000000000000000000000000000000000000000000000000";var m=n;if((p=n.indexOf("$$"))!=-1){if(o>1){q=i.substring(0,o-(""+q).length)+q}m=n.substring(0,p)+q+n.substring(p+2)}return m}var h;if(f){this.$6X=0}else{f=this.$7O;l=this.$6V}for(var a in f){var e;if(f[a].count){var c;for(var e=0;e<f[a].count;e++){c=e+bx.$checkNaN(f[a].start);f[a+c]={url:b(f[a].url,c,bx.$checkNaN(f[a].zero)),opacity:f[a].opacity}}delete f[a]}else{if(f[a].sprite){var k=0,j=0;for(var e=0;e<f[a].sprite.count;e++){j=f[a].sprite.size.h*Math.floor(e/f[a].sprite.cols);k=f[a].sprite.size.w*(e%f[a].sprite.cols);f[a+(e+1)]={url:f[a].url,size:{w:f[a].sprite.size.w,h:f[a].sprite.size.h},position:{x:-k,y:-j},opacity:f[a].opacity}}delete f[a]}}}for(var a in f){this.$6X++}if(this.$6X==0){if(l){l(0,0)}return true}this.$6W=0;this.$9L=0;var g=this;for(a in f){var d=new Image();d.onload=bxg.$6a(function(m,n,i){this.$60(m,n,i)},this,[d,a,l]);d.onerror=function(){g.$9L++;if((g.$6W+g.$9L)==g.$6X){if(l){l(g.$6W,g.$9L)}}bxg.Trace.log("BXG","errorImage",this.src,"CImageLoader.load")};this.$7O[a]=f[a];d.src=f[a].url}return true};bxg.CImageLoader.prototype.$60=function(a,c,b){this.$7O[c].$AZ=c;this.$7O[c].$9M=a;this.$7O[c].w=a.width;this.$7O[c].h=a.height;this.$6W++;if((this.$6W+this.$9L)==this.$6X){if(b){b(this.$6W,this.$9L)}}};bxg.CImageLoader.prototype.unload=function(f,d){if(!f||!(typeof f=="string"||f instanceof Array)){bxg.Trace.log("BXG","errorParameter","id="+f,"CImageLoader.unload");return false}var c;var b=[];if(f instanceof Array){b=f}else{if(d&&d.count>0){d.start=d.start||0;for(c=0;c<d.count;c++){b.push(f+(c+bx.$checkNaN(d.start)))}}else{b.push(f)}}var e=[];var a=[];for(c=0;c<b.length;c++){if(this.$7O[b[c]]){e.push(b[c]);delete this.$7O[b[c]].$9M;delete this.$7O[b[c]]}else{a.push(b[c])}}if(a.length>0){return false}else{return true}};bxg.CGameLoop=function(a){if(bx.inClassing){return}if(!bxg.playGround){bxg.Trace.log("BXG","error","new bxg.CGameLoop() is called prior to initializing bxg.init().","bxg.CGameLoop");return}if(bxg.game){bxg.Trace.log("BXG","warning","CGameLoop was created in bxg.init(). So don't creat CGameLoop on outside BXG.","CGameLoop()");if(a.tick){bxg.game.setTickInterval(a.tick)}return}this.$DF=a||{tick:100};this.tickInterval=this.$DF.tick;this.$6e=[];this.$63=[];this.$64=null;this.$9J=0;this.$66;this.$6R=[];this.$6f=[];return this};bxg.CGameLoop.prototype.init=function(a){if(a&&a.tick){this.tickInterval=a.tick}this.$CC();this.$9J=0;this.$66=0;return this};bxg.CGameLoop.prototype.$6k=function(a){this.$6f.push(a)};bxg.CGameLoop.prototype.$CC=function(){var c=this;var b=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame;if(!this.$64){if(b){function a(d){if(c.$6h.$5J){b(a);if(d-c.$6h.$5J>=c.tickInterval*0.8){c.$6h.$5J=d;c.$78()}}}this.$6h=this.$6h||{};this.$6h.$5J=new Date().getTime();b(a)}else{this.$64=setInterval(function(){c.$78()},c.tickInterval)}}};bxg.CGameLoop.prototype.$CB=function(){if(this.$64){if(this.$6h){this.$6h.$5J=0}else{clearInterval(this.$64)}delete this.$64}};bxg.CGameLoop.prototype.setTickInterval=function(a){if(!a){bxg.Trace.log("BXG","errorParameter","time="+a,"CGameLoop.setTickInterval");return}this.$CB();this.tickInterval=a;this.$CC()};bxg.CGameLoop.prototype.run=function(){if(this.$66===undefined){bxg.Trace.log("BXG","error","bxg.game.run() is called prior to initializing bxg.game.","CGameLoop.run");return}if(bxg.game.$6l){bxg.game.$6k({$6s:bxg.CGameLoop.prototype.run,$6o:this});return}if(this.$66==1||this.$66==2){this.end()}for(var a=0;a<this.$6e.length;a++){this.$6e[a].$7A(this.$9J)}this.$66=1;this.$78();if(bxg.Trace.logging){bxg.Trace.log("BXG","debug","Game started and CControl reset.","CGameLoop.run")}if(bxg.Inspector.$DV){bxg.Inspector.$DW()}};bxg.CGameLoop.prototype.pause=function(){this.$66=2;if(bxg.Inspector.$DV){bxg.Inspector.$DX()}};bxg.CGameLoop.prototype.resume=function(){if(this.$66==2){this.$66=1}if(bxg.Inspector.$DV){bxg.Inspector.$DW()}};bxg.CGameLoop.prototype.end=function(){if(bxg.game.$6l){bxg.game.$6k({$6s:bxg.CGameLoop.prototype.end,$6o:this});return}this.pause();this.$66=3;for(var a=0;a<this.$6e.length;a++){this.$6e[a].$CQ(this.$9J)}if(bxg.Trace.logging){bxg.Trace.log("BXG","debug","Game ended.","CGameLoop.end")}if(bxg.Inspector.$DV){bxg.Inspector.$DX()}};bxg.CGameLoop.prototype.addControl=function(b,a){if(!b||!(b instanceof bxg.CControl)){bxg.Trace.log("BXG","errorParameter","cntrl is not CControl or null","CGameLoop.addControl");return this}if(this.$66==1||this.$66==2){bxg.Trace.log("BXG","error","bxg.game.addControl() is called when bxg.game is in running state.","CGameLoop.addControl");return}if(a){this.removeAllControl()}this.$6e.push(b);function c(e,d){return e.$DF.zIndex-d.$DF.zIndex}this.$6e.sort(c);b.$HW(this);return this};bxg.CGameLoop.prototype.removeControl=function(b){if(!b||!(b instanceof bxg.CControl)){bxg.Trace.log("BXG","errorParameter","cntrl is not CControl or null","CGameLoop.removeControl");return}if(this.$66==1||this.$66==2){bxg.Trace.log("BXG","error","bxg.game.removeControl() is called when bxg.game is in running state.","CGameLoop.removeControl");return}for(var a=0;a<this.$6e.length;a++){if(this.$6e[a]==b){this.$6e[a].$HX();this.$6e.splice(a,1);break}}};bxg.CGameLoop.prototype.removeAllControl=function(){if(this.$66!==undefined&&(this.$66==1||this.$66==2)){bxg.Trace.log("BXG","error","bxg.game.removeAllControl() is called when bxg.game is in running state.","CGameLoop.removeAllControl");return}for(var a=0;a<this.$6e.length;a++){this.$6e[a].$HX()}this.$6e.length=0};bxg.CGameLoop.prototype.getControl=function(a){if(!a){bxg.Trace.log("BXG","errorParameter","CControl name="+a,"CGameLoop.getControl");return null}for(var b=0;b<this.$6e.length;b++){if(this.$6e[b].name&&this.$6e[b].name==a){return this.$6e[b]}}return null};bxg.CGameLoop.prototype.addInputDevice=function(a){if(!a||!(a instanceof bxg.CInputDevice)){bxg.Trace.log("BXG","errorParameter","device="+a,"CGameLoop.addInputDevice");return}if(this.$66==1||this.$66==2){bxg.Trace.log("BXG","error","Cannot call this function when bxg.game is in running state.","CGameLoop.addInputDevice");return}this.$63.push(a)};bxg.CGameLoop.prototype.getTick=function(){return this.$9J};bxg.CGameLoop.prototype.$78=function(){if(this.$6l){return}if(!this.$6e.length){return}if(this.$66!=1){return}this.$6l=true;if(bxg.Inspector.$DV){bxg.Inspector.$E1.LP.msORs=new Date().getTime()}for(this.$9s=0;this.$9s<this.$6e.length;this.$9s++){if(this.$6e[this.$9s].$HY==bxg.CControl.RUNSTATE.RUNNING){for(this.$9t in this.$6e[this.$9s].$68){this.$6i=this.$6e[this.$9s].$68[this.$9t];if(this.$6i.$6D!=this.$6i.__colActivated){this.$6i.__colActivated=this.$6i.$6D}if(this.$6i.active&&!this.$6i.$EL){this.$6i.$EL=true}if(this.$6i.$EL&&!this.$6i.$CE){this.$6i.tick(this.$9J)}}}}for(this.$9s=0;this.$9s<this.$6e.length;this.$9s++){if(this.$6e[this.$9s].$HY==bxg.CControl.RUNSTATE.RUNNING){for(this.$9t in this.$6e[this.$9s].$67){if(this.$6e[this.$9s].$67[this.$9t].$EL){if(this.$6e[this.$9s].$67[this.$9t].$7P){this.$6e[this.$9s].$67[this.$9t].render()}}}}}if(bxg.$E9&&bxg.$E9.$EG){bxg.$E9.$EG()}for(this.$9s=0;this.$9s<this.$6e.length;this.$9s++){if(this.$6e[this.$9s].$HY==bxg.CControl.RUNSTATE.RUNNING){if(!(bxg.$E9.$D9&bxg.$GI)){if(this.$6e[this.$9s].$EM.$EK){this.$6e[this.$9s].$EM.$EK()}}}}if(bxg.$E9&&bxg.$E9.$EQ){bxg.$E9.$EQ()}if(bxg.Inspector.$DV){bxg.Inspector.$E1.LP.msOR=new Date().getTime()-bxg.Inspector.$E1.LP.msORs}if(bxg.Inspector.$DV){bxg.Inspector.$E1.LP.msICCs=new Date().getTime()}for(this.$9t=0;this.$9t<this.$63.length;this.$9t++){this.$ER=this.$63[this.$9t].$6M(this.$9J);if(this.$ER){for(this.$9s=0;this.$9s<this.$6e.length;this.$9s++){if(this.$6e[this.$9s].$HY==bxg.CControl.RUNSTATE.RUNNING){if(this.$6e[this.$9s].$79&&this.$6e[this.$9s].$79.onInputEvent){this.$6e[this.$9s].$79.onInputEvent(this.$6e[this.$9s],this.$ER)}if(bxg.$Hp){for(this.$9u in this.$6e[this.$9s].$69){if(this.$6e[this.$9s].$69[this.$9u].$EL&&!this.$6e[this.$9s].$69[this.$9u].$CE){this.$6e[this.$9s].$69[this.$9u].$79.onInputEvent(this.$6e[this.$9s].$69[this.$9u],this.$ER)}}}}}this.$63[this.$9t].$6N()}}for(this.$9s=0;this.$9s<this.$6e.length;this.$9s++){if(this.$6e[this.$9s].$HY==bxg.CControl.RUNSTATE.RUNNING){for(this.$9u in this.$6e[this.$9s].$6B){this.$6e[this.$9s].$6B[this.$9u].$7E()}}}for(this.$9s=0;this.$9s<this.$6e.length;this.$9s++){if(this.$6e[this.$9s].$HY==bxg.CControl.RUNSTATE.RUNNING){for(this.$9t in this.$6e[this.$9s].$6A){if(this.$6e[this.$9s].$6A[this.$9t].$EL&&!this.$6e[this.$9s].$6A[this.$9t].$CE&&this.$6e[this.$9s].$6A[this.$9t].__colActivated){this.$6e[this.$9s].$6A[this.$9t].$9K()}}}}for(this.$9s=0;this.$9s<this.$6e.length;this.$9s++){if(this.$6e[this.$9s].$HY==bxg.CControl.RUNSTATE.RUNNING){this.$6e[this.$9s].$7D()}}if(bxg.Inspector.$DV){bxg.Inspector.$E1.LP.msICC=new Date().getTime()-bxg.Inspector.$E1.LP.msICCs}this.$9J++;if(this.$DO){this.$H0()}if(bxg.TransitionTag.count){bxg.TransitionTag.run()}this.$6l=false;if(this.$6f.length){while(this.$6n=this.$6f.shift()){this.$6n.$6s.call(this.$6n.$6o,this.$6n.$Hq)}}};bxg.CGameLoop.prototype.setTimer=function(c){if(!c||!c.time||!c.callback){bxg.Trace.log("BXG","errorParameter","event="+c,"CGameLoop.setTimer");bxg.Trace.data(c);return 0}var b=false;this.$6S=this.$6S||1;c.id=this.$6S++;c.after=(new Date()).getTime()+c.time;for(var a=0;a<this.$6R.length;a++){if(this.$6R[a].id==-1){this.$6R[a].id=c.id;this.$6R[a].time=c.time;this.$6R[a].after=c.after;this.$6R[a].callback=c.callback;this.$6R[a].once=c.once;b=true;break}}if(!b){this.$6R.push(c)}if(!this.$DO){this.$DO=1}else{this.$DO++}return c.id};bxg.CGameLoop.prototype.setTimeout=function(a,b){return this.setTimer({callback:a,time:b,once:true})};bxg.CGameLoop.prototype.setInterval=function(a,b){return this.setTimer({callback:a,time:b})};bxg.CGameLoop.prototype.clearTimer=function(b){for(var a=0;a<this.$6R.length;a++){if(this.$6R[a].id==b){this.$6R[a].id=-1;this.$DO--;break}}};bxg.CGameLoop.prototype.clearTimeout=function(a){this.clearTimer(a)};bxg.CGameLoop.prototype.clearInterval=bxg.CGameLoop.prototype.clearTimeout;bxg.CGameLoop.prototype.$H0=function(){if(!this.$DO){return}bxg.CGameLoop.prototype.$H0.$DP=(new Date()).getTime();for(bxg.CGameLoop.prototype.$H0.$9S=0;bxg.CGameLoop.prototype.$H0.$9S<this.$6R.length;bxg.CGameLoop.prototype.$H0.$9S++){if(this.$6R[bxg.CGameLoop.prototype.$H0.$9S].id>0&&bxg.CGameLoop.prototype.$H0.$DP>this.$6R[bxg.CGameLoop.prototype.$H0.$9S].after){this.$6R[bxg.CGameLoop.prototype.$H0.$9S].callback(this.$6R[bxg.CGameLoop.prototype.$H0.$9S].id);this.$6R[bxg.CGameLoop.prototype.$H0.$9S].after=bxg.CGameLoop.prototype.$H0.$DP+this.$6R[bxg.CGameLoop.prototype.$H0.$9S].time;if(this.$6R[bxg.CGameLoop.prototype.$H0.$9S].once){this.clearTimer(this.$6R[bxg.CGameLoop.prototype.$H0.$9S].id)}}}};bxg.CGameLoop.prototype.adjustByTick=function(b,c,a){if(!this.tickInterval){bxg.Trace.log("BXG","noGameLoop","because tickInterval="+this.tickInterval,"CGameLoop.adjustByTick");return 0}if(!b||c===undefined){bxg.Trace.log("BXG","errorParameter","tick="+b+" value="+c,"CGameLoop.adjustByTick");return 0}if(a){return Math.ceil(this.tickInterval/b*c)}else{return this.tickInterval/b*c}};bxg.CGameLoop.prototype.tickAfter=function(a,b){if(!b){bxg.Trace.log("BXG","errorParameter","msec="+b,"CGameLoop.tickAfter");return 0}if(a===undefined||a===null){return this.$9J+Math.ceil(b/this.tickInterval)}else{return a+Math.ceil(b/this.tickInterval)}};bxg.CControl=function(c,b,a){if(bx.inClassing){return}if(!bxg.area){bxg.Trace.log("BXG","error","new bxg.CControl() is called prior to initializing bxg.init().","bxg.CControl");return this}this.name=a;this.$DF=b||{};if(bxg.$9I&bxg.$E8&&!(bxg.$9I&bxg.$E7)){this.$DF.renderer=this.$DF.renderer||{};if(this.$DF.renderer.buffering!=false){this.$DF.renderer.buffering=true}}if(!this.$DF.zIndex){this.$DF.zIndex=0}else{this.$DF.zIndex*=(bxg.$9Y.$6b*bxg.$9Y.$EF)}this.$HM=null;this.map=null;this.logic=null;this.$67={};this.$68={};this.$69={};this.$6A={};this.$6B={};this.$6p=[];this.$6q={};this.$79=c;this.area={x:bxg.area.x,y:bxg.area.y,w:bxg.area.w,h:bxg.area.h};this.$HY=bxg.CControl.RUNSTATE.STOP;this.scrollPos={x:0,y:0};this.scrollSize={w:this.area.w,h:this.area.h};this.$DF.$ET=this.$DF.$ET||{$D9:bxg.$EU,$GF:bx.$copyObject({},this.area)};this.$DF.$ET.$EX=this.$EY||bxg.playGround;this.$DF.$ET.$F6=this.$DF.zIndex;if(this.$DF.$ET.$6r===undefined){this.$DF.$ET.$6r=0}if(this.$DF.renderer&&this.$DF.renderer.buffering){this.$DF.$ET.$6r|=bxg.$6t}if(this.$DF.renderer&&this.$DF.renderer.saveMemory){this.$DF.$ET.$6r|=bxg.$6u}this.$DF.$ET.$Hr={w:bxg.area.w,h:bxg.area.h};this.$EM=new bxg.$E9.$EZ(this.$DF.$ET);this.data={};return this};bxg.CControl.OBJCLASS_GENERAL=1;bxg.CControl.OBJCLASS_IMAGE=2;bxg.CControl.prototype.create=function(){if(this.$7Q){return this}this.$EM.$F0();this.$7Q=true;return this};bxg.CControl.prototype.destroy=function(){if(this.$HM){this.$HM.removeControl(this)}for(var a in this.$67){this.remove(a)}for(a in this.$6q){this.remove(a)}if(this.map){this.map.destroy();delete this.map}if(this.$EM){this.$EM.$F1();delete this.$EM}delete this.$67;delete this.$68;delete this.$69;delete this.$6A;delete this.$6B;this.$HM=null;delete this.logic;return null};bxg.CControl.prototype.$DQ=function(c,b,d,a){a.$DR=true;a.$8I=b+this.scrollPos.x;a.$8J=d+this.scrollPos.y};bxg.CControl.prototype.add=function(b){var a;if(!b){bxg.Trace.log("BXG","errorParameter","obj="+b,"CControl.add");return b}if(b instanceof bxg.CImageObject){a=bxg.CControl.OBJCLASS_IMAGE}else{if(b instanceof bxg.CObject){a=bxg.CControl.OBJCLASS_GENERAL}else{bxg.Trace.log("BXG","errorParameter","obj="+b,"CControl.add");return b}}if(a==bxg.CControl.OBJCLASS_IMAGE){if(!this.$6q[b.id]){this.$6q[b.id]=b}else{bxg.Trace.log("BXG","warning","Same CImageObject is alreay in this CControl, type="+b.type,"CControl.add");return b}}else{if(!this.$67[b.id]){this.$67[b.id]=b;if(b.$CT){this.$68[b.id]=b}if(b.$6C){this.$6B[b.id]=b}if(b.$79&&b.$79.onInputEvent){this.$69[b.id]=b}if(b.$79&&(b.$79.onCollision||b.$79.onCollisionAnalysis)&&b.$6C){this.$6A[b.id]=b}}else{bxg.Trace.log("BXG","warning","Same CObject is alreay in this CControl, id="+b.id,"CControl.add");return b}}b.$6v(this);b.setZindex();if(b.$F3){if(this.$EM.$F5){this.$EM.$F5(b.$F3)}}else{if(b.tag){(this.$EY||bxg.playGround).appendChild(b.tag)}}if(a==bxg.CControl.OBJCLASS_IMAGE){if(this.$HZ){if(b.$F3.$F4){b.$F3.$F4(true)}}}return b};bxg.CControl.prototype.remove=function(a){if(!a){bxg.Trace.log("BXG","errorParameter","object="+a,"CControl.remove");return a}var c;if(typeof a=="string"){c=a}else{c=a.id}var b;if(this.$6q[c]){b=this.$6q[c];if(this.$EM.$F7){this.$EM.$F7(this.$6q[c].$F3)}delete this.$6q[c];b.$6w(this)}else{if(this.$67[c]){b=this.$67[c];if(b.active){b.deactivate()}if(this.$68[c]){delete this.$68[c]}if(this.$6B[c]){delete this.$6B[c]}if(this.$69[c]){delete this.$69[c]}if(this.$6A[c]){delete this.$6A[c]}if(b.$F3){if(this.$EM.$F7){this.$EM.$F7(b.$F3)}}else{if(b.tag){if(b.tag.parentNode){b.tag.parentNode.removeChild(b.tag)}}}b.$6w(this);delete this.$67[c]}else{bxg.Trace.log("BXG","warning","Try to remove unregistered Game Object, type="+a.type,"CControl.remove")}}return a};bxg.CControl.prototype.removeAll=function(a){var b;var e;var c;var d=false;if(a&&a instanceof Array){d=true}for(e in this.$6q){c=this.$6q[e];if(d){a.push(c)}if(this.$EM.$F7){this.$EM.$F7(c.$F3)}delete this.$6q[e];c.$6w(this)}for(e in this.$67){c=this.$67[e];if(c.active){c.deactivate()}if(d){a.push(c)}if(c.$F3){if(this.$EM.$F7){this.$EM.$F7(c.$F3)}}else{if(c.tag){if(c.tag.parentNode){c.tag.parentNode.removeChild(c.tag)}}}c.$6w(this);delete this.$67[e]}this.$68={};this.$6B={};this.$69={};this.$6A={};if(d){return a}else{return null}};bxg.CControl.prototype.toControlScreenPosition=function(a,c,b){if(a===undefined||c===undefined){bxg.Trace.log("BXG","errorParameter","x="+a+" y="+c,"CControl.toControlScreenPosition");return{x:0,y:0}}b=b||{};b.x=a-this.scrollPos.x;b.y=c-this.scrollPos.y;return b};bxg.CControl.prototype.getZindexBase=function(){return this.$DF.zIndex};bxg.CControl.prototype.getZindexTop=function(){return this.$DF.zIndex+(bxg.$9Y.$6b-1)*bxg.$9Y.$EF};bxg.CControl.prototype.getRunState=function(){return this.$HY};bxg.CControl.prototype.$7D=function(){if(this.$79&&this.$79.onTick){this.$79.onTick(this,bxg.game.$9J)}};bxg.CControl.RUNSTATE={};bxg.CControl.RUNSTATE.STOP=0;bxg.CControl.RUNSTATE.RUNNING=1;bxg.CControl.RUNSTATE.PAUSE=2;bxg.CControl.prototype.$7A=function(a){if(this.$EM.$F8){this.$EM.$F8()}var b;for(b in this.$6q){if(this.$6q[b].$F3.$F4){this.$6q[b].$F3.$F4(true)}}this.$HZ=true;this.$HY=bxg.CControl.RUNSTATE.RUNNING;this.scrollReset();if(this.$79&&this.$79.onReset){this.$79.onReset(this,a)}};bxg.CControl.prototype.$CQ=function(a){var b;for(b in this.$67){if(this.$67[b].active){this.$67[b].deactivate()}}for(b in this.$6q){if(this.$6q[b].$F3.$F4){this.$6q[b].$F3.$F4(true)}}this.$HZ=false;this.$HY=bxg.CControl.RUNSTATE.STOP;if(this.$79&&this.$79.onEnd){this.$79.onEnd(this,a)}};bxg.CControl.prototype.pause=function(){if(this.$HY==bxg.CControl.RUNSTATE.RUNNING){this.$HY=bxg.CControl.RUNSTATE.PAUSE;return true}else{bxg.Trace.log("BXG","warning","not bxg.CControl.RUNSTATE.RUNNING. ignored.","bxg.CControl.pause()");return false}};bxg.CControl.prototype.resume=function(){if(this.$HY==bxg.CControl.RUNSTATE.PAUSE){this.$HY=bxg.CControl.RUNSTATE.RUNNING;return true}else{bxg.Trace.log("BXG","warning","not bxg.CControl.RUNSTATE.PAUSE. ignored.","bxg.CControl.resume()");return false}};bxg.CControl.prototype.$HW=function(a){this.$HM=a;if(this.$HZ){this.$HY=bxg.CControl.RUNSTATE.RUNNING}};bxg.CControl.prototype.$HX=function(){for(var a in this.$67){this.$67[a].deactivate()}for(var a in this.$6q){if(this.$6q[a].$F3.$F4){this.$6q[a].$F3.$F4(false)}}if(this.$EM.$F9){this.$EM.$F9()}this.$HZ=false;this.$HY=bxg.CControl.RUNSTATE.STOP};bxg.CControl.prototype.$CG=function(b){if(b){this.map=b}else{delete this.map}var a;if(b&&(a=b.getSize())){if(a.w<this.area.w||a.h<this.area.h){bxg.Trace.log("BXG","error","Map area size is smaller than view screen size.","CControl.SLM")}this.scrollSize.w=Math.max(this.area.w,a.w);this.scrollSize.h=Math.max(this.area.h,a.h)}};bxg.CControl.prototype.detectCollision=function(b,d,a){if(!bxg.CObject.$Ha(b)){bxg.Trace.log("BXG","errorParameter","geo="+b,"CControl.detectCollision");return null}if(d){this.$FA=null}for(this.$FB in this.$6B){if(this.$6B[this.$FB].active){if(this.$6B[this.$FB].$7F(b)){if(!a&&!d){return this.$6B[this.$FB]}else{if(!a&&d){if(!this.$FA||this.$FA.$DF.zIndex<this.$6B[this.$FB].$DF.zIndex){this.$FA=this.$6B[this.$FB]}}else{if(a){a.push(this.$6B[this.$FB])}}}}}}if(a){if(d){function c(f,e){return f.$DF.zIndex-e.$DF.zIndex}a.sort(c)}return a}return this.$FA};bxg.CControl.SCROLL_UP=0;bxg.CControl.SCROLL_DOWN=4;bxg.CControl.SCROLL_LEFT=2;bxg.CControl.SCROLL_RIGHT=6;bxg.CControl.prototype.$CM=function(b,c,a){this.scrollPos.x=b;this.scrollPos.y=c;if(a){a.x=b;a.y=c}};bxg.CControl.prototype.scroll=function(c,b,a){if(b!==undefined){b=parseInt(b);if(isNaN(b)){bxg.Trace.log("BXG","errorNaN","dy="+b,"CControl.scroll");b=this.scrollPos.y}else{b=this.scrollPos.y+b}}else{b=this.scrollPos.y}if(c!==undefined){c=parseInt(c);if(isNaN(c)){bxg.Trace.log("BXG","errorNaN","dx="+c,"CControl.scroll");c=this.scrollPos.x}else{c=this.scrollPos.x+c}}else{c=this.scrollPos.x}this.$CM(c,b,a);if(this.map&&this.map.$Hs){this.map.$Hs()}};bxg.CControl.prototype.scrollReset=function(){this.$CM(0,0)};bxg.CControl.prototype.$CK=function(){return false};bxg.CScrollControl=function(c,b,a){if(bx.inClassing){return}b=b||{};if(!b.size||typeof b.size!="object"){b.size={w:bxg.area.w,h:bxg.area.h}}else{if(bx.$checkNaN(parseInt(b.size.w))<bxg.area.w){b.size.w=bxg.area.w}if(bx.$checkNaN(parseInt(b.size.h))<bxg.area.h){b.size.h=bxg.area.h}if(bx.$checkNaN(parseInt(b.size.w))<=bxg.area.w&&bx.$checkNaN(parseInt(b.size.h))<=bxg.area.h){b.size={w:bxg.area.w,h:bxg.area.h}}}b.$ET=b.$ET||{$D9:bxg.$FI};b.$ET.$GF={x:0,y:0,w:b.size.w,h:b.size.h};bxg.CControl.call(this,c,b,a);this.scrollSize={w:this.$DF.size.w,h:this.$DF.size.h}};bx.$Inherit(bxg.CScrollControl,bxg.CControl);bxg.CScrollControl.prototype.$DQ=function(c,b,d,a){a.$DR=true;a.$8I=b;a.$8J=d};bxg.CScrollControl.prototype.$CM=function(b,c,a){if(a){a.x=0;a.y=0}if((c==0||c)&&this.scrollSize.h>=this.area.h){if(c>0){c=0}else{if(c<-(this.scrollSize.h-this.area.h)){c=-(this.scrollSize.h-this.area.h)}}if(a){a.y=c-this.scrollPos.y}this.scrollPos.y=c}if((b==0||b)&&this.scrollSize.w>=this.area.w){if(b>0){b=0}else{if(b<-(this.scrollSize.w-this.area.w)){b=-(this.scrollSize.w-this.area.w)}}if(a){a.x=b-this.scrollPos.x}this.scrollPos.x=b}if(b!==undefined||c!==undefined){this.$EM.$CM(b,c)}};bxg.CScrollControl.prototype.$CK=function(){return true};bxg.CScrollControl.prototype.$CG=function(a){bxg.CControl.prototype.$CG.call(this,a);if(a&&a.getSize()){this.$EM.$FJ({x:0,y:0,w:this.scrollSize.w,h:this.scrollSize.h})}};bxg.CBufferedScrollControl=function(c,b,a){if(bx.inClassing){return}b=b||{};b.renderer=b.renderer||{};if(b.renderer.buffering!=false){b.renderer.buffering=true}if(bxg.$9I&bxg.$E8){b.$ET={$D9:bxg.$6x}}else{bxg.Trace.log("BXG","warning","CBufferedScrollControl is not supported on DOM-only rendering mode. Performance will drop with huge area map.","bxg.CBufferedScrollControl()");b.$ET={$D9:bxg.$FI}}bxg.CScrollControl.call(this,c,b,a)};bx.$Inherit(bxg.CBufferedScrollControl,bxg.CScrollControl);bxg.C2WayBufferedScrollControl=function(c,b,a){if(bx.inClassing){return}b=b||{};b.dir=b.dir||"horizontal";if(b.dir=="vertical"){this.$6y=true}else{if(b.dir=="horizontal"){this.$6y=false}else{bxg.Trace.log("BXG","errorParameter","Invalid options.dir="+b.dir,"bxg.C2WayBufferedScrollControl()")}}if(bxg.$9I&bxg.$E8){if(this.$6y){b.$ET={$D9:bxg.$6z}}else{b.$ET={$D9:bxg.$7a}}}else{bxg.Trace.log("BXG","warning","CBufferedScrollControl is not supported on DOM-only rendering mode. Performance will drop with huge area map.","bxg.C2WayBufferedScrollControl()");b.$ET={$D9:bxg.$FI}}b.size=b.size||{w:bxg.area.w,h:bxg.area.h};if(this.$6y){b.size.w=bxg.area.w}else{b.size.h=bxg.area.h}bxg.CScrollControl.call(this,c,b,a)};bx.$Inherit(bxg.C2WayBufferedScrollControl,bxg.CScrollControl);bxg.C1WayBufferedScrollControl=function(c,b,a){if(bx.inClassing){return}b=b||{};b.renderer=b.renderer||{};if(b.renderer.buffering!=false){b.renderer.buffering=true}b.dir=b.dir||"down";b.size=parseInt(b.size);if(isNaN(b.size)||b.size<=0){bxg.Trace.log("BXG","warning","'size' is supposed to be a valid positive number, options.size="+b.size,"C1WayBufferedScrollControl()");b.size=0}if(b.dir=="up"){b.dir=bxg.CControl.SCROLL_UP;if(b.size<=bxg.area.h){b.size=bxg.area.h}b.$ET={$D9:bxg.$7b,$GF:{x:0,y:0,w:bxg.area.w,h:b.size}}}else{if(b.dir=="left"){b.dir=bxg.CControl.SCROLL_LEFT;if(b.size<=bxg.area.w){b.size=bxg.area.w}b.$ET={$D9:bxg.$7c,$GF:{x:0,y:0,w:b.size,h:bxg.area.h}}}else{if(b.dir=="right"){b.dir=bxg.CControl.SCROLL_RIGHT;if(b.size<=bxg.area.w){b.size=bxg.area.w}b.$ET={$D9:bxg.$7d,$GF:{x:0,y:0,w:b.size,h:bxg.area.h}}}else{if(b.dir!="down"){bxg.Trace.log("BXG","errorParameter","Invalid options.dir="+b.dir,"bxg.C1WayBufferedScrollControl()")}b.dir=bxg.CControl.SCROLL_DOWN;if(b.size<=bxg.area.h){b.size=bxg.area.h}b.$ET={$D9:bxg.$7e,$GF:{x:0,y:0,w:bxg.area.w,h:b.size}}}}}b.$ET.$FL=this;this.$EY=bxg.buffer;bxg.CControl.call(this,c,b,a);if(b.dir==bxg.CControl.SCROLL_LEFT){this.scrollSize.w=b.size;this.scrollSize.h=bxg.area.h}else{if(b.dir==bxg.CControl.SCROLL_RIGHT){this.scrollSize.w=b.size;this.scrollSize.h=bxg.area.h}else{if(b.dir==bxg.CControl.SCROLL_UP){this.scrollSize.w=bxg.area.w;this.scrollSize.h=b.size}else{this.scrollSize.w=bxg.area.w;this.scrollSize.h=b.size}}}this.$6Z=[];this.$Hs0=undefined};bx.$Inherit(bxg.C1WayBufferedScrollControl,bxg.CScrollControl);bxg.C1WayBufferedScrollControl.prototype.scrollReset=function(){if(this.$DF.dir==bxg.CControl.SCROLL_LEFT){this.scrollPos.x=0;this.scrollPos.y=0}else{if(this.$DF.dir==bxg.CControl.SCROLL_RIGHT){this.scrollPos.x=-(this.$DF.size-bxg.area.w);this.scrollPos.y=0}else{if(this.$DF.dir==bxg.CControl.SCROLL_UP){this.scrollPos.x=0;this.scrollPos.y=0}else{this.scrollPos.x=0;this.scrollPos.y=-(this.$DF.size-bxg.area.h)}}}this.$Hs1=undefined};bxg.C1WayBufferedScrollControl.prototype.$DQ=function(c,b,d,a){if(bxg.$9I&bxg.$E8){if(!(bxg.$9I&bxg.$E7)){return bxg.CScrollControl.prototype.$DQ.call(this,c,b,d,a)}if(c.$DF.baseLayer){return bxg.CScrollControl.prototype.$DQ.call(this,c,b,d,a)}}a.$DR=false;this.$Hb=d+c.$F3.$HQ.y;this.$Hc=b+c.$F3.$HQ.x;if(this.$DF.dir==bxg.CControl.SCROLL_DOWN){for(this.$GY=0;this.$GY<this.$6Z.length;this.$GY++){if((this.$Hb>=this.$DF.size-(this.$6Z[this.$GY].$A9+1)*this.$DF.paneSize&&this.$Hb<this.$DF.size-this.$6Z[this.$GY].$A9*this.$DF.paneSize)||(this.$Hb+c.$F3.$HQ.h>=this.$DF.size-(this.$6Z[this.$GY].$A9+1)*this.$DF.paneSize&&this.$Hb+c.$F3.$HQ.h<this.$DF.size-this.$6Z[this.$GY].$A9*this.$DF.paneSize)){this.$Hs2=this.$GY;a.$8I=b;a.$8J=d-(this.$DF.size-(this.$6Z[this.$GY].$A9+1)*this.$DF.paneSize);a.$DR=true;break}}}else{if(this.$DF.dir==bxg.CControl.SCROLL_UP){for(this.$GY=0;this.$GY<this.$6Z.length;this.$GY++){if((this.$Hb>=this.$6Z[this.$GY].$A9*this.$DF.paneSize&&this.$Hb<(this.$6Z[this.$GY].$A9+1)*this.$DF.paneSize)||(this.$Hb+c.$F3.$HQ.h>=this.$6Z[this.$GY].$A9*this.$DF.paneSize&&this.$Hb+c.$F3.$HQ.h<(this.$6Z[this.$GY].$A9+1)*this.$DF.paneSize)){this.$Hs2=this.$GY;a.$8I=b;a.$8J=d-this.$6Z[this.$GY].$A9*this.$DF.paneSize;a.$DR=true;break}}}else{if(this.$DF.dir==bxg.CControl.SCROLL_LEFT){for(this.$GY=0;this.$GY<this.$6Z.length;this.$GY++){if((this.$Hc>=this.$6Z[this.$GY].$A9*this.$DF.paneSize&&this.$Hc<(this.$6Z[this.$GY].$A9+1)*this.$DF.paneSize)||(this.$Hc+c.$F3.$HQ.w>=this.$6Z[this.$GY].$A9*this.$DF.paneSize&&this.$Hc+c.$F3.$HQ.w<(this.$6Z[this.$GY].$A9+1)*this.$DF.paneSize)){this.$Hs2=this.$GY;a.$8I=b-this.$6Z[this.$GY].$A9*this.$DF.paneSize;a.$8J=d;a.$DR=true;break}}}else{if(this.$DF.dir==bxg.CControl.SCROLL_RIGHT){for(this.$GY=0;this.$GY<this.$6Z.length;this.$GY++){if((this.$Hc>=this.$DF.size-(this.$6Z[this.$GY].$A9+1)*this.$DF.paneSize&&this.$Hc<this.$DF.size-this.$6Z[this.$GY].$A9*this.$DF.paneSize)||(this.$Hc+c.$F3.$HQ.w>=this.$DF.size-(this.$6Z[this.$GY].$A9+1)*this.$DF.paneSize&&this.$Hc+c.$F3.$HQ.w<this.$DF.size-this.$6Z[this.$GY].$A9*this.$DF.paneSize)){this.$Hs2=this.$GY;a.$8I=b-(this.$DF.size-(this.$6Z[this.$GY].$A9+1)*this.$DF.paneSize);a.$8J=d;a.$DR=true;break}}}}}}if(c.$F3.$FO){if(!a.$DR){bxg.buffer.appendChild(c.$F3.$FO)}else{if(c.$F3.$FO.parentNode!=this.$6Z[this.$Hs2]){this.$6Z[this.$Hs2].appendChild(c.$F3.$FO)}}}};bxg.C1WayBufferedScrollControl.prototype.$7A=function(a){bxg.CScrollControl.prototype.$7A.call(this,a);this.$Hs0=undefined;if(bxg.$9I&bxg.$E8&&!(bxg.$9I&bxg.$E7)){return this}this.$CP();return this};bxg.C1WayBufferedScrollControl.prototype.$HX=function(){bxg.CScrollControl.prototype.$HX.call(this);if(bxg.$9I&bxg.$E8&&!(bxg.$9I&bxg.$E7)){return}if(this.$6Z[0]){this.$6Z[0].style.display="none"}if(this.$6Z[1]){this.$6Z[1].style.display="none"}};bxg.C1WayBufferedScrollControl.prototype.create=function(){if(this.$7Q){return this}bxg.CScrollControl.prototype.create.call(this);if(bxg.$9I&bxg.$E8&&!(bxg.$9I&bxg.$E7)){return this}this.$CP(true);return this};bxg.C1WayBufferedScrollControl.prototype.destroy=function(){bxg.CScrollControl.prototype.destroy.call(this);if(bxg.$9I&bxg.$E8&&!(bxg.$9I&bxg.$E7)){return null}for(var a=0;a<this.$6Z.length;a++){this.$6Z[a].parentNode.removeChild(this.$6Z[a]);delete this.$6Z[a]}delete this.$6Z;return null};bxg.C1WayBufferedScrollControl.prototype.$CP=function(b){if(bxg.$9I&bxg.$E8&&!(bxg.$9I&bxg.$E7)){return}var a;if(this.$DF.dir==bxg.CControl.SCROLL_DOWN||this.$DF.dir==bxg.CControl.SCROLL_UP){if(!this.$DF.paneSize||this.$DF.paneSize<this.area.h){this.$DF.paneSize=this.area.h}a=this.$DF.paneSize;if(this.$DF.dir==bxg.CControl.SCROLL_DOWN){if(b){this.$6Z.push(bxg.playGround.$TAG("div",{id:"1"},{position:"absolute",left:"0px",top:(this.area.h-a)+"px",width:this.area.w+"px",height:a+"px",overflow:"visible"}));this.$6Z.push(bxg.playGround.$TAG("div",{id:"2"},{position:"absolute",left:"0px",top:(this.area.h-a-a)+"px",width:this.area.w+"px",height:a+"px",overflow:"visible"}))}else{this.$6Z[0].style.top=(this.area.h-a)+"px";this.$6Z[1].style.top=(this.area.h-a-a)+"px"}}else{if(b){this.$6Z.push(bxg.playGround.$TAG("div",{},{position:"absolute",left:"0px",top:"0px",width:this.area.w+"px",height:a+"px",overflow:"visible"}));this.$6Z.push(bxg.playGround.$TAG("div",{},{position:"absolute",left:"0px",top:a+"px",width:this.area.w+"px",height:a+"px",overflow:"visible"}))}else{this.$6Z[0].style.top="0px";this.$6Z[1].style.top=a+"px"}}}else{if(!this.$DF.paneSize||this.$DF.paneSize<this.area.w){this.$DF.paneSize=this.area.w}a=this.$DF.paneSize;if(this.$DF.dir==bxg.CControl.SCROLL_RIGHT){if(b){this.$6Z.push(bxg.playGround.$TAG("div",{},{position:"absolute",left:(this.area.w-a)+"px",top:"0px",width:a+"px",height:this.area.h+"px",overflow:"visible"}));this.$6Z.push(bxg.playGround.$TAG("div",{},{position:"absolute",left:(this.area.w-a-a)+"px",top:"0px",width:a+"px",height:this.area.h+"px",overflow:"visible"}))}else{this.$6Z[0].style.left=(this.area.w-a)+"px";this.$6Z[1].style.left=(this.area.w-a-a)+"px"}}else{if(b){this.$6Z.push(bxg.playGround.$TAG("div",{},{position:"absolute",left:"0px",top:"0px",width:a+"px",height:this.area.h+"px",overflow:"visible"}));this.$6Z.push(bxg.playGround.$TAG("div",{},{position:"absolute",left:a+"px",top:"0px",width:a+"px",height:this.area.h+"px",overflow:"visible"}))}else{this.$6Z[0].style.left="0px";this.$6Z[1].style.left=a+"px"}}}this.$6Z[0].style.display="block";this.$6Z[1].style.display="block"};bxg.C1WayBufferedScrollControl.prototype.$CG=function(a){bxg.CScrollControl.prototype.$CG.call(this,a);if(a&&a.getSize()){if(this.$DF.dir==bxg.CControl.SCROLL_DOWN||this.$DF.dir==bxg.CControl.SCROLL_UP){this.$DF.size=this.scrollSize.h;if(this.$6Z[0]){this.$6Z[0].style.width=this.scrollSize.w+"px"}if(this.$6Z[1]){this.$6Z[1].style.width=this.scrollSize.w+"px"}}else{this.$DF.size=this.scrollSize.w;if(this.$6Z[0]){this.$6Z[0].style.height=this.scrollSize.h+"px"}if(this.$6Z[1]){this.$6Z[1].style.height=this.scrollSize.h+"px"}}}};bxg.C1WayBufferedScrollControl.prototype.$7f=function(a){for(var b in this.$67){if(this.$67[b].active&&!this.$67[b].$CE){this.$67[b].render()}}for(b in this.$6q){this.$6q[b].move(this.$6q[b].$7g,this.$6q[b].$7h)}if(this.$6Z[a%2]){if(this.$6Z[a%2].style.backgroundImage&&this.$6Z[a%2].$9v){if(this.$DF.dir==bxg.CControl.SCROLL_UP){this.$6Z[a%2].style.backgroundPosition="0px "+((this.$DF.paneSize-this.$DF.paneSize*a)%this.$6Z[a%2].$9v.h)+"px"}else{if(this.$DF.dir==bxg.CControl.SCROLL_DOWN){this.$6Z[a%2].style.backgroundPosition="0px "+((this.$DF.paneSize*a)%this.$6Z[a%2].$9v.h)+"px"}else{if(this.$DF.dir==bxg.CControl.SCROLL_LEFT){this.$6Z[a%2].style.backgroundPosition=((this.$DF.paneSize-this.$DF.paneSize*a)%this.$6Z[a%2].$9v.w)+"px 0px"}else{if(this.$DF.dir==bxg.CControl.SCROLL_RIGHT){this.$6Z[a%2].style.backgroundPosition=((this.$DF.paneSize*a)%this.$6Z[a%2].$9v.w)+"px 0px"}}}}}}};bxg.C1WayBufferedScrollControl.prototype.$7i=function(){if(bxg.$9I&bxg.$E8&&!(bxg.$9I&bxg.$E7)){return}if(this.$DF.dir==bxg.CControl.SCROLL_LEFT||this.$DF.dir==bxg.CControl.SCROLL_RIGHT){if(parseInt(this.$6Z[0].style.top)!=this.scrollPos.y){this.$6Z[0].style.top=this.scrollPos.y+"px"}if(parseInt(this.$6Z[1].style.top)!=this.scrollPos.y){this.$6Z[1].style.top=this.scrollPos.y+"px"}}else{if(parseInt(this.$6Z[0].style.left)!=this.scrollPos.x){this.$6Z[0].style.left=this.scrollPos.x+"px"}if(parseInt(this.$6Z[1].style.left)!=this.scrollPos.x){this.$6Z[1].style.left=this.scrollPos.x+"px"}}if(this.$DF.dir==bxg.CControl.SCROLL_LEFT||this.$DF.dir==bxg.CControl.SCROLL_RIGHT){if(this.$Hs1!=this.scrollPos.x){this.$Hs1=this.scrollPos.x}else{return}}else{if(this.$Hs1!=this.scrollPos.y){this.$Hs1=this.scrollPos.y}else{return}}this.$AC=1;if(this.$DF.dir==bxg.CControl.SCROLL_DOWN){this.$Hs4=Math.floor((this.scrollSize.h+this.scrollPos.y-this.area.h)/this.area.h);this.$Hs5=Math.floor(this.$Hs4)%2;this.$6Z[this.$Hs5].style.top=((this.scrollSize.h+this.scrollPos.y)%this.area.h)+"px";this.$6Z[(this.$Hs5+1)%2].style.top=(parseInt(this.$6Z[this.$Hs5].style.top)-this.area.h)+"px"}else{if(this.$DF.dir==bxg.CControl.SCROLL_UP){this.$Hs4=Math.floor(Math.abs(this.scrollPos.y)/this.area.h);this.$Hs5=Math.floor(this.$Hs4)%2;this.$6Z[this.$Hs5].style.top=(this.scrollPos.y%this.area.h)+"px";this.$6Z[(this.$Hs5+1)%2].style.top=(this.scrollPos.y%this.area.h+this.area.h)+"px"}else{if(this.$DF.dir==bxg.CControl.SCROLL_RIGHT){this.$Hs4=Math.floor((this.scrollSize.w+this.scrollPos.x-this.area.w)/this.area.w);this.$Hs5=Math.floor(this.$Hs4)%2;this.$6Z[this.$Hs5].style.left=((this.scrollSize.w+this.scrollPos.x)%this.area.w)+"px";this.$6Z[(this.$Hs5+1)%2].style.left=(parseInt(this.$6Z[this.$Hs5].style.left)-this.area.w)+"px"}else{this.$Hs4=Math.floor(Math.abs(this.scrollPos.x)/this.area.w);this.$Hs5=Math.floor(this.$Hs4)%2;this.$6Z[this.$Hs5].style.left=(this.scrollPos.x%this.area.w)+"px";this.$6Z[(this.$Hs5+1)%2].style.left=(this.scrollPos.x%this.area.w+this.area.w)+"px"}}}if(this.$Hs4>this.$Hs0||this.$Hs0===undefined){this.$6Z[this.$Hs5].$A9=this.$Hs4;this.$7f(this.$Hs4);this.$Hs0=this.$Hs4}if(this.$Hs4+1>this.$Hs0||this.$Hs0===undefined){this.$6Z[(this.$Hs5+1)%2].$A9=this.$Hs4+1;this.$7f(this.$Hs4+1);this.$Hs0=this.$Hs4+1}};bxg.C1WayBufferedScrollControl.prototype.scroll=function(c,b,a){if(b===undefined){bxg.Trace.log("BXG","warning","C1WayBufferedScrollControl.scroll(delta) is deprecated. Please, call in CScrollControl.scroll() specification.","C1WayBufferedScrollControl.scroll");return}if(this.$DF.dir==bxg.CControl.SCROLL_LEFT){if(c>0){bxg.Trace.log("BXG","warning","Sign of dx should be a minus value.","C1WayBufferedScrollControl.scroll");return}}else{if(this.$DF.dir==bxg.CControl.SCROLL_RIGHT){if(c<0){bxg.Trace.log("BXG","warning","Sign of dx should be a plus value.","C1WayBufferedScrollControl.scroll");return}}else{if(this.$DF.dir==bxg.CControl.SCROLL_UP){if(b>0){bxg.Trace.log("BXG","warning","Sign of dy should be a minus value.","C1WayBufferedScrollControl.scroll");return}}else{if(this.$DF.dir==bxg.CControl.SCROLL_DOWN){if(b<0){bxg.Trace.log("BXG","warning","Sign of dy should be a plus value.","C1WayBufferedScrollControl.scroll");return}}}}}bxg.CScrollControl.prototype.scroll.call(this,c,b,a)};bxg.C1WayBufferedScrollControl.prototype.$CK=function(){return true};bxg.CObject=function(k,d,o,n,a){if(bx.inClassing){return}if(!k){bxg.Trace.log("BXG","errorParameter","type="+k,"CObject()");return}if(!d&&!(this instanceof bxg.CTagObject)){bxg.Trace.log("BXG","errorParameter","type="+k+",info="+d,"CObject()");return}var c=0;if(!(this instanceof bxg.CCompositeObject)&&d instanceof Object&&!(d instanceof bxg.$Ht1)){c=1}else{if(this instanceof bxg.CCompositeObject&&d instanceof Object&&d.sprites){c=2}}var g,f;if(c){this.type=k;var l=bxg.ObjectFactory.$HA(k);var b=false;if(l&&l.$Hd){b=true}this.$DF=o||{};if(c==1){if(b){this.$He=bx.$copyObject({},d)}else{this.$He=d}var h={};var m=false;for(g in this.$He){if(this.$He[g].sprite&&this.$He[g].sprite.length){h[g]=this.$He[g].sprite;m=true}else{bxg.Trace.log("BXG","noProperty","No 'sprite' of state="+g+" of obj="+k,"CObject()")}if(this.$He[g].cdShape){if(!(this.$He[g].cdShape instanceof Array)||!this.$He[g].cdShape.length){bxg.Trace.log("BXG","noProperty","Type or data error in 'cdShape' of state="+g+" of obj="+k,"CObject()");delete this.$He[g].cdShape}else{for(f=0;f<this.$He[g].cdShape.length;f++){if(!bxg.CObject.$Ha(this.$He[g].cdShape[f])){bxg.Trace.log("BXG","error","Collision detection shape format error in state="+g+",object="+this.type,"CObject()");bxg.Trace.data(this.$He[g].cdShape[f])}}}}if(this.$He[g].offset){if(isNaN(Number(this.$He[g].offset.x))||isNaN(Number(this.$He[g].offset.y))){bxg.Trace.log("BXG","noProperty","No numeric value in 'offset' of state="+g+" of obj="+k,"CObject()");this.$He[g].offset.x=0;this.$He[g].offset.y=0}}}if(m){if(b){this.$Hf(h)}this.sprites=new bxg.$Ht1(h)}else{bxg.Trace.log("BXG","noProperty","No sprites in info of obj="+k,"CObject()")}}else{this.$He=d;this.sprites=d.sprites;var e;for(g in this.sprites){if(this.sprites[g].sprite){if(b){this.$Hf(this.sprites[g].sprite)}this.sprites[g].sprite=new bxg.$Ht1(this.sprites[g].sprite)}else{bxg.Trace.log("BXG","noProperty","No 'sprite' of state="+g+" of obj="+k,"CObject()")}}}this.id=bxg.ObjectFactory.$Hl++;this._initSpr()}else{this.$DF=a||{};this.$DF.cdShape=o;this.$DF.manager=n;if(this.$DF.recycle!==false){this.$DF.recycle=true}this.id=k;this.sprites=d;this.type=this.$DF.type}this.control=null;if(bxg.$Hp){this.level=null}this.size={w:0,h:0};this._initOpt();this.$DY();this.$7Y={x:0,y:0};this.$7H={x:0,y:0};this.$6E={};if(this.sprites&&this.sprites instanceof bxg.$Ht1){this.$CT=this.sprites.$CT()}if(this.$79&&this.$79.onTick){this.$CT=true}};bxg.CObject.prototype._initOpt=function(){if(this.$DF.noRecycle){this.$DF.recycle=false}else{this.$DF.recycle=true}if(this.$DF.cdShape){this.$6C=this.$DF.cdShape;if(this.$6C&&this.$6C.length){for(var a=0;a<this.$6C.length;a++){if(!bxg.CObject.$Ha(this.$6C[a])){bxg.Trace.log("BXG","error","Collision detection shape format error in object="+this.type,"CObject()");bxg.Trace.data(this.$6C[a])}}}}else{if(this.$6C){this.$6C=undefined}}if(this.$DF.manager){this.$79=this.$DF.manager}else{if(this.$79){this.$79=undefined}}this.$FQ(this.$DF.zIndex)};bxg.CObject.prototype.$DY=function(){this.active=false;this.$EL=false;this.$6D=true;this.__colActivated=true;this.$CE=false;this.$7P=false;this.$FV=false;this.$Hm=false;if(bxg.$Hp){this.data={bxgState:0,$FZ:{}}}else{this.data={$FZ:{}}}this.$7Z={x:0,y:0}};bxg.CObject.prototype._initSpr=function(){if(this instanceof bxg.CCompositeObject){var a;for(a in this.sprites){this.sprites[a].sprite.setSpeed(1);this.sprites[a].sprite.setLoop(true);this.sprites[a].sprite.$7n();if(this.sprites[a].sprite){if(this.sprites[a].speed){this.sprites[a].sprite.setSpeed(this.sprites[a].speed)}if(this.sprites[a].noLoop){this.sprites[a].sprite.setLoop(false)}}}}else{if(this.sprites){this.sprites.setSpeed(1);this.sprites.setLoop(true);this.sprites.$7n();if(this.$DF.sprite){if(this.$DF.sprite.speed){this.sprites.setSpeed(this.$DF.sprite.speed)}if(this.$DF.sprite.loop&&this.$DF.loop==false){this.sprites.setLoop(false)}}}}};bxg.CObject.COLLISION_OBJECT=1;bxg.CObject.COLLISION_TILE=2;bxg.CObject.$Ha=function(a){if(!a||!(a instanceof Object)){return false}if(a.rect||a.circle||a.point){a.data=a.rect||a.circle||a.point;if(a.rect){a.shape="rect"}if(a.circle){a.shape="circle"}if(a.point){a.shape="point"}a.data.x0=a.data.x;a.data.y0=a.data.y}if(!a.shape||!a.data){return false}if(a.shape=="circle"){if(isNaN(Number(a.data.x0))||isNaN(Number(a.data.y0))||isNaN(Number(a.data.r))){return false}}else{if(a.shape=="rect"){if(isNaN(Number(a.data.x0))||isNaN(Number(a.data.y0))||isNaN(Number(a.data.w))||isNaN(Number(a.data.h))){return false}}else{if(a.shape=="point"){if(isNaN(Number(a.data.x0))||isNaN(Number(a.data.y0))){return false}}else{return false}}}return true};bxg.CObject.prototype.create=function(){if(bxg.Inspector.$DV&&bxg.Inspector.$H5.$H6){if(bxg.Inspector.$H5.$H6==this.id){bxg.Inspector.$H7("try to create()")}}if(!this.sprites){bxg.Trace.log("BXG","errorParameter","sprites=null of "+this.type,"CObject.create");return}if(!(this.$H1=this.sprites.$7k())){bxg.Trace.log("BXG","emptySprite","of "+this.type,"CObject.create");return}var a=bxg.$FT;if(this.$DF.baseLayer){a|=bxg.$7t}this.$F3=bxg.$E9.$7l({$GJ:this.$H1,$F6:this.$DF.zIndex,$D9:a});this.$7C();if(bxg.Inspector.$DV&&bxg.Inspector.$H5.$H6){if(bxg.Inspector.$H5.$H6==this.id){bxg.Inspector.$H7("create()")}}return this};bxg.CObject.prototype.destroy=function(){if(this.$FV){return}if(bxg.game.$6l){bxg.game.$6k({$6s:bxg.CObject.prototype.destroy,$6o:this});return}if(bxg.Inspector.$DV&&bxg.Inspector.$H5.$H6){if(bxg.Inspector.$H5.$H6==this.id){bxg.Inspector.$H7("try to destroy()")}}this.$Hm=false;if(this.$AD){var a;for(a in this.$AD){if(this.$AD[a].destroy){this.$AD[a].object.destroy()}}delete this.$AD}this.deactivate();if(this.control){this.control.remove(this)}if(bxg.Inspector.$DV&&bxg.Inspector.$H5.$H6){if(bxg.Inspector.$H5.$H6==this.id){bxg.Inspector.$H7("destroy()")}}if(!bxg.ObjectFactory.$FW(this)){if(this.$F3){this.$F3.$F1();delete this.$F3}else{if(this.tag){delete this.tag}}this.$FV=true;return}if(bxg.Inspector.$DV&&bxg.Inspector.$H5.$H6){if(bxg.Inspector.$H5.$H6==this.id){bxg.Inspector.$H7("recycle()")}}this.$FV=true;this.$Hm=true};bxg.CObject.prototype.$7C=function(){if(this.sprites&&(this.$H1=this.sprites.$7k())){if(this.$H1.size){this.$DF.size=this.$H1.size}}if(this.$DF.size){this.size.w=this.$DF.size.w;this.size.h=this.$DF.size.h}else{this.size.w=this.$H1?this.$H1.w:0;this.size.h=this.$H1?this.$H1.h:0}if(this.$H1&&this.$79&&this.$79.onInit){this.$79.onInit(this)}return this};bxg.CObject.prototype.addChild=function(b,a){if(this.$FV){bxg.Trace.log("BXG","errorInvalidState","destroyed","CObject.addChild");return}if(!b){bxg.Trace.log("BXG","errorParameter","no object","CObject.addChild");return}if(b.parent){bxg.Trace.log("BXG","warning",b.type+" is alreay a child object, it cannot be child to the other without removing from the current parent","CObject.addChild");b.parent.removeChild(b)}this.$AD=this.$AD||{};this.$AD[b.id]=a||{};this.$AD[b.id].object=b;b.parent=this};bxg.CObject.prototype.removeChild=function(a){if(this.$FV){bxg.Trace.log("BXG","errorInvalidState","destroyed","CObject.removeChild");return}if(typeof a=="string"){if(this.$AD&&this.$AD[a]){a=this.$AD[a.id]}}if(!this.$AD||!this.$AD[a.id]){bxg.Trace.log("BXG","unknownObject",a.type+":"+a.id,"CObject.removeChild");return}delete this.$AD[a.id].object.parent;delete this.$AD[a.id]};bxg.CObject.prototype.getChildList=function(){return this.$AD};bxg.CObject.prototype.hasChild=function(){if(!this.$AD){return false}for(bxg.CObject.prototype.hasChild.$BG in this.$AD){return true}return false};bxg.CObject.prototype.$Hf=function(c){var a;for(var b in c){for(a=0;a<c[b].length;a++){c[b][a]=this.type+"_"+c[b][a]}}};bxg.CObject.prototype.setCurSpriteState=function(b,a){if(this.$FV){bxg.Trace.log("BXG","warnInvalidState","destroyed","CObject.setCurSpriteState");return}if(this.sprites){if(a){this.sprites.$7n(b,true)}else{this.sprites.$7n(b)}}else{bxg.Trace.log("BXG","warnNoSprites","CObject.setCurSpriteState")}};bxg.CObject.prototype.queueSpriteState=function(a){if(this.$FV){bxg.Trace.log("BXG","warnInvalidState","destroyed","CObject.queueSpriteState");return}if(this.sprites){this.sprites.$7o(a)}else{bxg.Trace.log("BXG","warnNoSprites","CObject.queueSpriteState")}};bxg.CObject.prototype.getCurSpriteState=function(){if(this.$FV){return null}if(this.sprites){return this.sprites.$FR()}else{bxg.Trace.log("BXG","warnNoSprites","CObject.getCurSpriteState")}return null};bxg.CObject.prototype.hasSpriteState=function(a){if(this.$FV){return null}if(this.sprites){return this.sprites.$7q[a]}else{bxg.Trace.log("BXG","warnNoSprites","CObject.hasSpriteState")}return null};bxg.CObject.prototype.doesCurSpritePlayEnd=function(){if(this.$FV){return true}if(this.sprites){return this.sprites.$7r()}else{bxg.Trace.log("BXG","warnNoSprites","CObject.doesCurSpritePlayEnd")}return true};bxg.CObject.prototype.$FQ=function(a){if(a){this.$DF.zIndex=a*bxg.$9Y.$EF}else{this.$DF.zIndex=0}};bxg.CObject.prototype.$__getSpriteStatesInfo=function(){if(this.sprites){return this.sprites.$7q}};bxg.CObject.prototype.setZindex=function(a){if(this.$FV){bxg.Trace.log("BXG","errorInvalidState","destroyed","CObject.setZindex");return}if(a!==undefined){this.$FQ(a)}if(this.$F3){if(this.control){this.$F3.$FQ(this.control.getZindexBase()+this.$DF.zIndex)}else{this.$F3.$FQ(this.$DF.zIndex)}}else{if(this.tag){if(this.control){this.tag.style.zIndex=(this.control.getZindexBase()+this.$DF.zIndex)}else{this.tag.style.zIndex=this.$DF.zIndex}}}if(bxg.Inspector.$DV&&bxg.Inspector.$H5.$H6){if(bxg.Inspector.$H5.$H6==this.id){bxg.Inspector.$H7("setZindex("+a+")")}}};bxg.CObject.prototype.getZindex=function(){return parseInt(this.$DF.zIndex/bxg.$9Y.$EF)};bxg.CObject.prototype.activate=function(a){if(this.$FV){bxg.Trace.log("BXG","errorInvalidState","destroyed","CObject.activate");return this}if(this.active){return this}if(!this.control&&!a){bxg.Trace.log("BXG","warnObjectNoControl","activate.(type="+this.type+")","CObject.activate")}if(bxg.$6c[this.type]&&bxg.$6c[this.type].images&&!bxg.$6c[this.type].$B5){bxg.Trace.log("BXG","warnObjectUnloaded",this.type+":"+this.id,"CObject.activate")}this.active=true;this.$CE=false;if(bxg.game.$6l){this.$EL=false}else{this.$EL=true}this.useCollisionDetection(true);if(bxg.$Hp){this.data.bxgState=0}this.setCurSpriteState(undefined,true);if(this.$79&&this.$79.onActivate){this.$79.onActivate(this,bxg.game.$9J)}if(this.$AD){var b;for(b in this.$AD){if(this.$AD[b].life){this.$AD[b].object.activate(a)}}}if(bxg.Inspector.$DV&&bxg.Inspector.$H5.$H6){if(bxg.Inspector.$H5.$H6==this.id){bxg.Inspector.$H7("activate()")}}return this};bxg.CObject.prototype.show=function(){this.$3K=true;if(this.$F3){if(this.$F3.$F4){this.$F3.$F4(true)}}else{if(this.tag){this.tag.style.display="block"}}if(bxg.$E9.$D9&bxg.$EV){this._realRendering(bxg.game.$9J);this.render()}if(this.$AD){var a;for(a in this.$AD){if(this.$AD[a].life){this.$AD[a].object.show()}}}if(bxg.Inspector.$DV&&bxg.Inspector.$H5.$H6){if(bxg.Inspector.$H5.$H6==this.id){bxg.Inspector.$H7("show()")}}return this};bxg.CObject.prototype.deactivate=function(){if(!this.active){return this}this.active=false;this.$EL=false;this.$3K=false;if(this.$F3){if(this.$F3.$F4){this.$F3.$F4(false)}}else{if(this.tag){this.tag.style.display="none"}}if(this.$AD){var a;for(a in this.$AD){if(this.$AD[a].life){this.$AD[a].object.deactivate()}}}if(bxg.Inspector.$DV&&bxg.Inspector.$H5.$H6){if(bxg.Inspector.$H5.$H6==this.id){bxg.Inspector.$H7("deactivate()")}}return this};bxg.CObject.prototype.pause=function(){this.$CE=true;if(bxg.Inspector.$DV&&bxg.Inspector.$H5.$H6){if(bxg.Inspector.$H5.$H6==this.id){bxg.Inspector.$H7("pause()")}}return this};bxg.CObject.prototype.resume=function(){this.$CE=false;if(bxg.Inspector.$DV&&bxg.Inspector.$H5.$H6){if(bxg.Inspector.$H5.$H6==this.id){bxg.Inspector.$H7("resume()")}}return this};bxg.CObject.prototype.render=function(){bxg.CObject.prototype.render.$DU=bxg.CObject.prototype.render.$DU||{};if(this.control){this.control.$DQ(this,(this.$7Z.x+this.$7Y.x),(this.$7Z.y+this.$7Y.y),bxg.CObject.prototype.render.$DU)}else{bxg.CObject.prototype.render.$DU.$DR=true;bxg.CObject.prototype.render.$DU.$8I=(this.$7Z.x+this.$7Y.x);bxg.CObject.prototype.render.$DU.$8J=(this.$7Z.y+this.$7Y.y)}if(bxg.CObject.prototype.render.$DU.$DR){if(this.$F3){this.$F3.$FY(bxg.CObject.prototype.render.$DU.$8I,bxg.CObject.prototype.render.$DU.$8J)}else{if(this.tag){this.tag.style.left=bxg.CObject.prototype.render.$DU.$8I+"px";this.tag.style.top=bxg.CObject.prototype.render.$DU.$8J+"px"}}}this.$7P=false;return};bxg.CObject.prototype.useCollisionDetection=function(a){this.$6D=a;if(!bxg.game.$6l){this.__colActivated=a}if(bxg.Inspector.$DV&&bxg.Inspector.$H5.$H6){if(bxg.Inspector.$H5.$H6==this.id){bxg.Inspector.$H7("useCollisionDetection("+a+")")}}};bxg.CObject.prototype.tick=function(a){if(a===undefined){this.$H8=this.$H8||1;a=this.$H8++}if(!this.active){return}if(this.$79&&this.$79.onOutView){if(this.overViewScreen(null,true)){this.$79.onOutView(this)}}if(this.$79&&this.$79.onTick){this.$79.onTick(this,a)}this._realRendering(a)};bxg.CObject.prototype.move=function(a,d,c){this.$Hs3=this.$Hs3||{};if(!isNaN(parseInt(d))){this.$Hs3.y=(this.control&&c?-this.control.scrollPos.y:0)+d;if(this.$7Z.y!=this.$Hs3.y){this.$7Z.y=this.$Hs3.y;this.$7P=true}}if(!isNaN(parseInt(a))){this.$Hs3.x=(this.control&&c?-this.control.scrollPos.x:0)+a;if(this.$7Z.x!=this.$Hs3.x){this.$7Z.x=this.$Hs3.x;this.$7P=true}}if(this.$AD){var b;for(b in this.$AD){if(this.$AD[b].move){this.$AD[b].object.move((!isNaN(parseInt(a)))&&this.$AD[b].offset&&this.$AD[b].offset.x?a+this.$AD[b].offset.x:a,(!isNaN(parseInt(d)))&&this.$AD[b].offset&&this.$AD[b].offset.y?d+this.$AD[b].offset.y:d,c)}}}};bxg.CObject.prototype.moveBy=function(b,a){if(!isNaN(parseInt(a))){this.$AF=this.$7Z.y+a}if(!isNaN(parseInt(b))){this.$BH=this.$7Z.x+b}this.move(this.$BH,this.$AF);if(this.$AD){var c;for(c in this.$AD){if(this.$AD[c].moveBy||this.$AD[c].move){this.$AD[c].object.moveBy(b,a)}}}};bxg.CObject.$FG=function(a,b){if(b.position){if(!a.$FH){a.src=bx.c.bx$nullImage}if(!a.$FH){a.style.width=b.size.w+"px"}if(!a.$FH){a.style.height=b.size.h+"px"}a.style.backgroundImage="url('"+b.url+"')";a.style.backgroundPosition=b.position.x+"px "+b.position.y+"px";a.$FH=true}else{a.src=b.url}if(b.opacity!==undefined){a.$CSS({opacity:b.opacity})}else{a.$CSS({opacity:1})}};bxg.CObject.prototype.position=function(a){if(this.control&&a){this.$7H.x=this.$7Z.x+this.control.scrollPos.x;this.$7H.y=this.$7Z.y+this.control.scrollPos.y}else{this.$7H.x=this.$7Z.x;this.$7H.y=this.$7Z.y}return this.$7H};bxg.CObject.prototype.center=function(a){this.position(a);this.$7I=this.$7I||{};this.$7I.x=this.$7H.x+Math.round(this.size.w/2);this.$7I.y=this.$7H.y+Math.round(this.size.h/2);return this.$7I};bxg.CObject.prototype._realRendering=function(a){if(this.sprites&&this.sprites instanceof bxg.$Ht1){this.$AE=this.sprites.$7D(a);if(this.$AE&&(this.$H1!=this.$AE)){this.$H1=this.$AE;if(this.$F3){this.$F3.$FF(this.$AE)}else{if(this.tag){bxg.CObject.$FG(this.tag,this.$AE)}}if(this.$He&&this.$He[this.sprites.$7w]){if(this.$He[this.sprites.$7w].offset){if(this.$7Y.x!=this.$He[this.sprites.$7w].offset.x||this.$7Y.y!=this.$He[this.sprites.$7w].offset.y){this.$7Y.x=this.$He[this.sprites.$7w].offset.x;this.$7Y.y=this.$He[this.sprites.$7w].offset.y;this.$7P=true}}else{if(this.$7Y.x||this.$7Y.y){this.$7Y.x=0;this.$7Y.y=0;this.$7P=true}}if(this.$6C){if(this.$He[this.sprites.$7w].cdShape){if(this.$He[this.sprites.$7w].cdShape!=this.$6C){this.$6C=this.$He[this.sprites.$7w].cdShape}}else{if(this.$6C!=this.$DF.cdShape){this.$6C=this.$DF.cdShape}}}}}}};bxg.CObject.prototype.$7E=function(a){this.position(a?false:true);this.$6E.x=this.$7H.x;this.$6E.y=this.$7H.y;this.$6E.w=this.size.w;this.$6E.h=this.size.h;for(var b=0;b<this.$6C.length;b++){this.$6C[b].data.x=this.$6C[b].data.x0+this.$6E.x;this.$6C[b].data.y=this.$6C[b].data.y0+this.$6E.y}};bxg.CObject.prototype.$7F=function(a){if(!a){return false}for(this.data.$FZ.$FB=0;this.data.$FZ.$FB<this.$6C.length;this.data.$FZ.$FB++){this.data.$FZ.$81=bxg.CObject.$G0[this.$6C[this.data.$FZ.$FB].shape+"_"+a.shape];return this.data.$FZ.$81(this.$6C[this.data.$FZ.$FB].data,a.data)}return false};bxg.CObject.prototype.$G1=function(a,b){a.data.$FZ.$80=true;if(this.$6C.length==1&&this.$6C[0].shape=="rect"&&a.$6C.length==1&&a.$6C[0].shape=="rect"){a.data.$FZ.$80=false}if(a.data.$FZ.$80&&!bxg.Geometry.intersect_rect_rect(a.$6E,this.$6E)){return false}for(a.data.$FZ.$FB=0;a.data.$FZ.$FB<this.$6C.length;a.data.$FZ.$FB++){for(a.data.$FZ.$FA=0;a.data.$FZ.$FA<a.$6C.length;a.data.$FZ.$FA++){a.data.$FZ.$81=bxg.CObject.$G0[this.$6C[a.data.$FZ.$FB].shape+"_"+a.$6C[a.data.$FZ.$FA].shape];if(a.data.$FZ.$81(this.$6C[a.data.$FZ.$FB].data,a.$6C[a.data.$FZ.$FA].data,b)){return true}}}return false};bxg.CObject.prototype.$9K=function(a){this.data.$FZ.ret=false;for(this.data.$FZ.k2=0;this.data.$FZ.k2<bxg.game.$6e.length;this.data.$FZ.k2++){for(this.data.$FZ.j in bxg.game.$6e[this.data.$FZ.k2].$6B){if(bxg.game.$6e[this.data.$FZ.k2].$6B[this.data.$FZ.j]!=this&&bxg.game.$6e[this.data.$FZ.k2].$6B[this.data.$FZ.j].active&&bxg.game.$6e[this.data.$FZ.k2].$6B[this.data.$FZ.j].__colActivated){if(this.$79.onCollisionAnalysis){this.data.$FZ.$G3=this.data.$FZ.$G3||{};if(this.$G1(bxg.game.$6e[this.data.$FZ.k2].$6B[this.data.$FZ.j],this.data.$FZ.$G3)){if(!a){this.data.$FZ.$G3.type=bxg.CObject.COLLISION_OBJECT;this.$79.onCollisionAnalysis(this,bxg.game.$6e[this.data.$FZ.k2].$6B[this.data.$FZ.j],this.data.$FZ.$G3)}else{if(this.$79.onCollisionCheck){this.data.$FZ.ret=this.$79.onCollisionCheck(this,bxg.game.$6e[this.data.$FZ.k2].$6B[this.data.$FZ.j])}else{this.data.$FZ.ret=true}}}}else{if(this.$G1(bxg.game.$6e[this.data.$FZ.k2].$6B[this.data.$FZ.j])){if(!a){this.$79.onCollision(this,bxg.game.$6e[this.data.$FZ.k2].$6B[this.data.$FZ.j])}else{if(this.$79.onCollisionCheck){this.data.$FZ.ret=this.$79.onCollisionCheck(this,bxg.game.$6e[this.data.$FZ.k2].$6B[this.data.$FZ.j])}else{this.data.$FZ.ret=true}}}}}}}return this.data.$FZ.ret};bxg.CObject.prototype.overViewScreen=function(b,a,c){if(this.control){return this.$7K(b,this.control.area,true,a,c)}else{return false}};bxg.CObject.prototype.overControlScreen=function(b,a,c){if(this.control){return this.$7K(b,this.control.scrollSize,false,a,c)}else{return false}};bxg.CObject.prototype.$7K=function(c,d,f,a,e){this.position(f);var b=false;if(c){c.x=0;c.y=0}if(!a){if(this.$7H.x<(0+(e&&e.left?e.left:0))){if(c){c.x=1}b=true}else{if(this.$7H.x>(d.w-this.size.w-(e&&e.right?e.right:0))){if(c){c.x=2}b=true}}if(this.$7H.y<(0+(e&&e.top?e.top:0))){if(c){c.y=1}b=true}else{if(this.$7H.y>(d.h-this.size.h-(e&&e.bottom?e.bottom:0))){if(c){c.y=2}b=true}}}else{if(this.$7H.x+this.size.w<0){if(c){c.x=1}b=true}else{if(this.$7H.x>d.w){if(c){c.x=2}b=true}}if(this.$7H.y+this.size.h<0){if(c){c.y=1}b=true}else{if(this.$7H.y>d.h){if(c){c.y=2}b=true}}}return b};bxg.CObject.prototype.$6v=function(b){this.control=b;if(bxg.$Hp){this.level=b}if(this.$AD){var a;for(a in this.$AD){if(this.$AD[a].life){b.add(this.$AD[a].object)}}}};bxg.CObject.prototype.$6w=function(b){if(bxg.$Hp){if(this.level){delete this.level}}if(this.control){delete this.control}if(this.$AD){var a;for(a in this.$AD){if(this.$AD[a].life){b.remove(this.$AD[a].object)}}}};bxg.CImageObject=function(c,b){if(bx.inClassing){return}if(!c){bxg.Trace.log("BXG","errorParameter","idImg="+c,"CImageObject()");return}if(!bxg.images[c]){bxg.Trace.log("BXG","unknownImageId",c,"CImageObject()");return}this.$DF=b||{};this.id=bxg.ObjectFactory.$Hl++;this.type=c;this.control=null;if(bxg.$Hp){this.level=null}this.$FQ(this.$DF.zIndex);if(this.$DF.resize){this.size=this.$DF.resize}else{this.size=bxg.images[c].size?{w:bxg.images[c].size.w,h:bxg.images[c].size.h}:{w:bxg.images[c].w,h:bxg.images[c].h}}if(this.$DF.noRecycle){this.$DF.recycle=false}else{this.$DF.recycle=true}this.$7g=this.$7h=0;var a=0;if(this.$DF.baseLayer){a|=bxg.$7t}if(this.$DF.pattern){a|=bxg.$7u}this.$F3=bxg.$E9.$7l({$GJ:bxg.images[c],$D9:a,$GW:this.$DF.resize,$GK:this.$DF.rotate,$F6:this.$DF.zIndex})};bxg.CImageObject.prototype.destroy=function(){if(this.$FV){return}if(bxg.game.$6l){bxg.game.$6k({$6s:bxg.CImageObject.prototype.destroy,$6o:this});return}if(this.control){this.control.remove(this)}this.$Hm=false;if(this.$F3.$F4){this.$F3.$F4(false)}if(!bxg.ObjectFactory.$FW(this)){this.$F3.$F1();delete this.$F3;this.$FV=true;return}this.$FV=true;this.$Hm=true};bxg.CImageObject.prototype.move=function(a,b){this.$7v=this.$7v||{};if(this.control){this.control.$DQ(this,a,b,this.$7v)}else{bxg.Trace.log("BXG","warnObjectNoControl","move.(image="+this.type+")","CImageObject.move");this.$7v.$DR=false}if(this.$7v.$DR){this.$F3.$FY(this.$7v.$8I,this.$7v.$8J)}this.$7g=a;this.$7h=b};bxg.CImageObject.prototype.$FQ=bxg.CObject.prototype.$FQ;bxg.CImageObject.prototype.setZindex=bxg.CObject.prototype.setZindex;bxg.CImageObject.prototype.$6v=function(a){this.control=a;this.active=true;if(bxg.$Hp){this.level=a}};bxg.CImageObject.prototype.$6w=function(a){this.active=false;if(bxg.$Hp){if(this.level){delete this.level}}if(this.control){delete this.control}};bxg.CObjectBase=bxg.CObject;bxg.CTagObject=function(e,d,c,b,a){if(bx.inClassing){return}bxg.CObjectBase.call(this,e,d,c,b,a);this.$DF.recycle=false};bx.$Inherit(bxg.CTagObject,bxg.CObjectBase);bxg.CTagObject.prototype.create=function(a){if(bxg.Inspector.$DV&&bxg.Inspector.$H5.$H6){if(bxg.Inspector.$H5.$H6==this.id){bxg.Inspector.$H7("try to create()")}}if(a){this.tag=a;this.tag.style.position="absolute";this.tag.style.display="none"}if(this.sprites&&(!a||a.tagName=="IMG")){if(this.$H1=this.sprites.$7k()){if(!bxg.$EA){bxg.Trace.log("BXG","unknownClass","CTagObject requires 'DOM Renderer' module","CTagObject.create")}else{this.$F3=new bxg.$EA.$EH({$GJ:this.$H1,$F6:this.$DF.zIndex,$D9:bxg.$FT,$G2:a});this.tag=this.$F3.$FO}}}if(!this.tag){bxg.Trace.log("BXG","noProperty","No Tag or sprite","CTagObject.create")}this.$7C();if(bxg.Inspector.$DV&&bxg.Inspector.$H5.$H6){if(bxg.Inspector.$H5.$H6==this.id){bxg.Inspector.$H7("create()")}}return this};bxg.CTagObject.prototype.setZindex=function(){};bxg.CCompositeObject=function(d,g,a,h,f,e){if(bx.inClassing){return}if(g instanceof Object&&g.states&&g.sprites){if(!d||!g||!a){bxg.Trace.log("BXG","errorParameter","type="+d+",info="+g+",opts="+a,"CCompositeObject()");return}if(!g.states||!g.sprites){bxg.Trace.log("BXG","errorParameter","info.states="+g.states+",info.sprites="+g.sprites,"CCompositeObject()");return}if(!a.size){bxg.Trace.log("BXG","errorParameter","opts.size="+a.size,"CCompositeObject()");return}g=bx.$copyObject({},g);this.$CX={};var b;for(var c in g.states){if(!g.states[c].config){bxg.Trace.log("BXG","noProperty","No 'config' for state="+c,"CCompositeObject()")}else{this.$CX[c]=g.states[c].config}if(g.states[c].cdShape){if(!(g.states[c].cdShape instanceof Array)||!g.states[c].cdShape.length){bxg.Trace.log("BXG","noProperty","Type or data error in 'cdShape' of state="+c+" of obj="+d,"CCompositeObject()");delete g.states[c].cdShape}else{for(b=0;b<g.states[c].cdShape.length;b++){if(!bxg.CObject.$Ha(g.states[c].cdShape[b])){bxg.Trace.log("BXG","error","Collision detection shape format error in state="+c+",object="+d,"CCompositeObject()");bxg.Trace.data(g.states[c].cdShape[b])}}}}}bxg.CObject.call(this,d,g,a)}else{this.$CX=a;bxg.CObject.call(this,d,g,h,f,e)}};bx.$Inherit(bxg.CCompositeObject,bxg.CObject);bxg.CCompositeObject.prototype.create=function(){if(bxg.Inspector.$DV&&bxg.Inspector.$H5.$H6){if(bxg.Inspector.$H5.$H6==this.id){bxg.Inspector.$H7("try to create()")}}if(bxg.$9I&bxg.$E7){this.tag=bxg.playGround.$TAG("div",{style:"position:absolute;display:none"});if(this.$DF.size&&this.$DF.size.w){this.tag.$CSS({width:this.$DF.size.w+"px"})}if(this.$DF.size&&this.$DF.size.h){this.tag.$CSS({height:this.$DF.size.h+"px"})}}this.$7C();if(bxg.Inspector.$DV&&bxg.Inspector.$H5.$H6){if(bxg.Inspector.$H5.$H6==this.id){bxg.Inspector.$H7("create()")}}return this};bxg.CCompositeObject.prototype.destroy=function(){if(bxg.game.$6l){bxg.game.$6k({$6s:bxg.CCompositeObject.prototype.destroy,$6o:this});return}bxg.CObject.prototype.destroy.call(this);if(!this.$Hm){for(var a in this.sprites){if(this.sprites[a].$F3){this.sprites[a].$F3.$F1()}delete this.sprites[a]}}};bxg.CCompositeObject.prototype.$7C=function(){if(!this.sprites||!this.$DF.size){return}this.size=this.$DF.size;var b;for(var a in this.sprites){if(!(b=this.sprites[a].sprite.$7k())){continue}this.sprites[a].$F3=bxg.$E9.$7l({$GJ:b,$F6:this.$DF.zIndex+bx.$checkNaN(this.sprites[a].zIndex),$D9:bxg.$FT});if(this.tag){this.tag.appendChild(this.sprites[a].$F3.$FO)}this.sprites[a].$8G={x:0,y:0};if(this.sprites[a].offset){if(this.sprites[a].offset.left!==undefined){this.sprites[a].$8G.x=this.sprites[a].offset.left}else{if(this.sprites[a].offset.right!==undefined){this.sprites[a].$8G.x=this.size.w-(b.w+this.sprites[a].offset.right)}}if(this.sprites[a].offset.top!==undefined){this.sprites[a].$8G.y=this.sprites[a].offset.top}else{if(this.sprites[a].offset.bottom!==undefined){this.sprites[a].$8G.y=this.size.h-(b.h+this.sprites[a].offset.bottom)}}}if(this.tag){this.sprites[a].$F3.$FY(this.sprites[a].$8G.x,this.sprites[a].$8G.y)}}if(this.$79&&this.$79.onInit){this.$79.onInit(this)}return this};bxg.CCompositeObject.prototype.$6v=function(a){bxg.CObject.prototype.$6v.call(this,a);if(!this.tag){for(this.$AG in this.sprites){if(this.control.$EM.$F5){this.control.$EM.$F5(this.sprites[this.$AG].$F3)}}}};bxg.CCompositeObject.prototype.$6w=function(a){if(!this.tag){for(this.$AG in this.sprites){if(this.control.$EM.$F7){this.control.$EM.$F7(this.sprites[this.$AG].$F3)}}}bxg.CObject.prototype.$6w.call(this,a)};bxg.CCompositeObject.prototype.render=function(){bxg.CObject.prototype.render.call(this);if(!this.tag){if(bxg.CObject.prototype.render.$DU.$DR){for(this.$AG in this.sprites){this.sprites[this.$AG].$F3.$FY(bxg.CObject.prototype.render.$DU.$8I+this.sprites[this.$AG].$8G.x,bxg.CObject.prototype.render.$DU.$8J+this.sprites[this.$AG].$8G.y)}}}};bxg.CCompositeObject.prototype.tick=function(a,b){bxg.CObject.prototype.tick.call(this,a,b);for(this.$AG in this.sprites){if(this.sprites[this.$AG].$G5&&this.sprites[this.$AG].sprite&&this.sprites[this.$AG].$F3){this.$AE=this.sprites[this.$AG].sprite.$7D(a);if(this.$AE&&(this.sprites[this.$AG].$AH!=this.$AE)){this.sprites[this.$AG].$AH=this.$AE;this.sprites[this.$AG].$F3.$FF(this.$AE)}}}if(this.$6C&&this.$He){if(this.$He.states[this.$D0]){if(this.$He.states[this.$D0].cdShape){if(this.$He.states[this.$D0].cdShape!=this.$6C){this.$6C=this.$He.states[this.$D0].cdShape}}else{if(this.$6C!=this.$DF.cdShape){this.$6C=this.$DF.cdShape}}}}return this};bxg.CCompositeObject.prototype.setZindex=function(a){bxg.CObject.prototype.setZindex.call(this,a);if(!this.tag){for(this.$AG in this.sprites){if(this.control){this.sprites[this.$AG].$F3.$FQ(this.control.getZindexBase()+this.$DF.zIndex+bx.$checkNaN(parseInt(this.sprites[this.$AG].zIndex)))}else{this.sprites[this.$AG].$F3.$FQ(this.$DF.zIndex+bx.$checkNaN(parseInt(this.sprites[this.$AG].zIndex)))}}}};bxg.CCompositeObject.prototype.setCurSpriteState=function(d,b){if(!d){for(d in this.$CX){break}}if(!d||!this.$CX[d]){bxg.Trace.log("BXG","errorParameter","state="+d,"CCompositeObject.setCurSpriteState");return false}if(this.$D0==d&&!b){return}this.$D0=d;var c;for(var a in this.$CX[d]){if(!this.sprites[a]){bxg.Trace.log("BXG","unknownSpriteId",a,"CCompositeObject.setCurSpriteState");continue}if(this.$CX[d][a].hide){this.sprites[a].$G5=false;if(this.sprites[a].$F3.$F4){this.sprites[a].$F3.$F4(false)}}else{if(this.$CX[d][a].group){this.sprites[a].$G5=true;if(this.sprites[a].$F3.$F4){this.sprites[a].$F3.$F4(true)}if(typeof this.$CX[d][a].group=="string"){this.sprites[a].sprite.$7n(this.$CX[d][a].group,b)}else{if(this.$CX[d][a].group.length){for(c=0;c<this.$CX[d][a].group.length;c++){if(c==0){this.sprites[a].sprite.$7n(this.$CX[d][a].group[c],b)}else{this.sprites[a].sprite.$7o(this.$CX[d][a].group[c])}}}}this.sprites[a].sprite.setLoop(this.sprites[a].noLoop?false:true)}}}if(bxg.Inspector.$DV&&bxg.Inspector.$H5.$H6){if(bxg.Inspector.$H5.$H6==this.immediately){bxg.Inspector.$H7("setCurSpriteState("+d+","+queue+")")}}};bxg.CCompositeObject.prototype.queueSpriteState=function(){bxg.Trace.log("BXG","error","CCompositeObject.queueSpriteState() is not supproted","CCompositeObject.queueSpriteState")};bxg.CCompositeObject.prototype.getCurSpriteState=function(){return this.$D0};bxg.CCompositeObject.prototype.hasSpriteState=function(a){return this.$CX[a]};bxg.CCompositeObject.prototype.doesCurSpritePlayEnd=function(a){if(this.sprites&&this.sprites[a]){if(this.sprites[a].$G5){if(this.sprites[a].sprite.$D3.length!=0||!this.sprites[a].sprite.$7r()){return false}}else{bxg.Trace.log("BXG","warning","doesCurSpritePlayEnd() called for hidden state="+a,"CCompositeObject.doesCurSpritePlayEnd")}}else{bxg.Trace.log("BXG","unknownSpriteGroup",a,"CCompositeObject.doesCurSpritePlayEnd")}return true};bxg.CCompositeObject.prototype.$__getSpriteStateInfo=function(){return this.$CX};bxg.CCanvasObject=function(b,c){if(bx.inClassing){return}if(!b||!c){bxg.Trace.log("BXG","errorParameter","Invalid parameter render="+b+" or options="+c,"CCanvasObject()");return}if(!c.size){bxg.Trace.log("BXG","errorParameter","This property is mandatory: options.size","CCanvasObject()");return}this.$DF=c;this.type="bxg$typeCanvasObj";this.id=bxg.ObjectFactory.$Hl++;this.size=this.$DF.size;this.control=null;this.$FQ(this.$DF.zIndex);this.$7g=this.$7h=0;var a=0;if(this.$DF.baseLayer){a|=bxg.$7t}this.$F3=bxg.$E9.$7l({$GD:{$D9:1,$GZ:b,$D8:{object:this}},$GW:this.size,$D9:a,$F6:this.$DF.zIndex})};bx.$Inherit(bxg.CCanvasObject,bxg.CImageObject);bxg.CCanvasObject.prototype.update=function(){this.$F3.$HT()};bxg.$Ht1=function(b,a){if(bx.inClassing){return}this.$7q=b||{};this.$DF=a||{};this.$D3=[];if(this.$DF.speed){this.$D2=this.$DF.speed}else{this.$D2=1}if(this.$DF.loop&&this.$DF.loop==false){this.$AI=false}else{this.$AI=true}this.$6P=-1;this.$7n()};bxg.$Ht1.prototype.$CT=function(){var b=0;var c;for(var a in this.$7q){if(!c){c=a}b++;if(b>1){break}}if(b>1){return true}else{if(b==1&&this.$7q[c].length>1){return true}else{return false}}};bxg.$Ht1.prototype.setSpeed=function(a){this.$D2=a;return this};bxg.$Ht1.prototype.setLoop=function(a){this.$AI=a;return this};bxg.$Ht1.prototype.$7n=function(b,a){if(!b){var c;for(c in this.$7q){b=c;break}if(!b){bxg.Trace.log("BXG","noProperty","no images and groups","CSprites.$7n");return}}if(this.$7q[b]&&this.$7q[b].length>0){if(this.$7w!=b||a){this.$D3.length=0;this.$7w=b;this.$72=-1}}else{bxg.Trace.log("BXG","unknownSpriteGroup",b,"CSprites.$7n");this.$7w=null}return};bxg.$Ht1.prototype.$7x=function(a){return this.$7q[a]};bxg.$Ht1.prototype.$FR=function(){return this.$7w};bxg.$Ht1.prototype.$7r=function(){if(!this.$7w){return true}if(this.$72==this.$7q[this.$7w].length-1){return true}return false};bxg.$Ht1.prototype.$7k=function(){if(!this.$7w){bxg.Trace.log("BXG","unknownSpriteGroup","null","CSprites.CR");return bxg.$Ht1.prototype.$7k.$G6}this.$G7=(this.$72<0)?0:this.$72;if(this.$7q[this.$7w][this.$G7]){if(bxg.images){this.$G8=bxg.images[this.$7q[this.$7w][this.$G7]];if(this.$G8){return this.$G8}else{bxg.Trace.log("BXG","unknownImageId",this.$7q[this.$7w][this.$G7],"CSprites.CR")}}}else{bxg.Trace.log("BXG","unknownImageId",this.$7q[this.$7w][cur],"CSprites.CR")}return bxg.$Ht1.prototype.$7k.$G6};bxg.$Ht1.prototype.$7k.$G6={};bxg.$Ht1.prototype.$7o=function(a){this.$D3.push(a)};bxg.$Ht1.prototype.$7D=function(a){if(!this.$7w){return{}}if((this.$6P+this.$D2)<=a){this.$AJ=1;if(this.$72==this.$7q[this.$7w].length-1){if(this.$D3.length>0){this.$BN=this.$D3.shift();this.$7n(this.$BN)}else{if(!this.$AI){this.$AJ=0}}}this.$72=(this.$72+this.$AJ)%this.$7q[this.$7w].length;this.$6P=a}return this.$7k()};bxg.WalkerLinear={};bxg.WalkerLinear.set=function(b,a){if(!b||!a){bxg.Trace.log("BXG","errorParameter","Invalid parameter obj="+b+" or options="+a,"bxg.WalkerLinear.set");return}if(isNaN(Number(a.radian))&&isNaN(Number(a.degree))&&!a.position){bxg.Trace.log("BXG","errorParameter","Parameter options requires property of radian or degree or position","bxg.WalkerLinear.set");return}if(a.distance!==undefined){a.speed=a.distance}if(isNaN(Number(a.speed))){bxg.Trace.log("BXG","errorParameter","Parameter options requires proper 'speed' property","bxg.WalkerLinear.set");return}b.data.$HtD=b.data.$HtD||{};b.data.$HtD.$Hg=a.interpolation;b.data.$HtD.$Hh=a.position;b.data.$HtD.$Hi=-1;if(a.position){a.radian=bxg.Geometry.getAngle(b.position(),a.position,true);b.data.$HtD.$Hj=bxg.Geometry.getDistance(b.position(),a.position);b.data.$HtD.$Hi=Math.floor(b.data.$HtD.$Hj/a.speed)}else{if(a.radian===undefined&&a.degree!==undefined){a.radian=bxg.Geometry.getDegToRad(a.degree)}}b.data.$HtD.$Hk=Math.sin(bx.$checkNaN(a.radian))*bx.$checkNaN(a.speed);b.data.$HtD.$Hn=-Math.cos(bx.$checkNaN(a.radian))*bx.$checkNaN(a.speed);if(a.player&&b.control&&b.control.map&&b.control.map.getTileMap){a.layer=b.control.map.getTileMap().$D5}if(a.layer&&b.control&&b.control.map&&b.control.map.getTileMap){b.setZindex(b.control.map.getTileMap().getZindex(a.layer,a.player?"player":"object"))}};bxg.WalkerLinear.move=function(a){if(a.data.$HtD.$Hh){if(a.data.$HtD.$Hi==0){if(a.$79&&a.$79.onWalkerEnd){a.$79.onWalkerEnd(a,bxg.game.$9J)}a.data.$HtD.$Hi--;return}else{if(a.data.$HtD.$Hi<0){return}else{if(a.data.$HtD.$Hi==1){a.data.$HtD.$Hk=a.data.$HtD.$Hh.x-a.position().x;a.data.$HtD.$Hn=a.data.$HtD.$Hh.y-a.position().y}}}}a.data.$HtD.$8D=false;if(a.data.$HtD.$Hg){a.data.$HtD.$8E=Math.sqrt(Math.pow(a.data.$HtD.$Hk,2)+Math.pow(a.data.$HtD.$Hn,2));a.data.$HtD.$8G=a.data.$HtD.$8G||{};a.data.$HtD.$8G.x=a.position().x;a.data.$HtD.$8G.y=a.position().y;while(a.data.$HtD.$8E>a.data.$HtD.$Hg){a.data.$HtD.$8E-=a.data.$HtD.$Hg;a.moveBy(Math.round(a.data.$HtD.$Hg*Math.sin(a.data.$HtD.radian)),Math.round(a.data.$HtD.$Hg*Math.cos(a.data.$HtD.radian)));a.$7E();a.data.$HtD.$8D=a.$9K(true);if(a.data.$HtD.$8D){break}}if(!a.data.$HtD.$8D){a.move(a.data.$HtD.$8G.x+a.data.$HtD.$Hk,a.data.$HtD.$8G.y+a.data.$HtD.$Hn)}}else{a.moveBy(a.data.$HtD.$Hk,a.data.$HtD.$Hn)}a.data.$HtD.$Hi--};bxg.WalkerParabolic2D={};bxg.WalkerParabolic2D.set=function(g,d,c){if(!d){bxg.Trace.log("BXG","noProperty","motion","bxg.WalkerParabolic2D.set");bxg.Trace.data(d);return}var e=0;var a=d.dTime||(bxg.game.tickInterval/1000)||0.1;var h=0;var f=0;var b=0;if(d.pxpy){if(isNaN(parseInt(d.pxpy.pX))||isNaN(parseInt(d.pxpy.pY))||!d.pxpy.pT){bxg.Trace.log("BXG","noProperty","px_py_pt","bxg.WalkerParabolic2D.set");bxg.Trace.data(d.pxpy);return}d.pxpy.pX=parseInt(d.pxpy.pX);d.pxpy.pY=parseInt(d.pxpy.pY);d.pxpy.sX=bx.$checkNaN(parseInt(d.pxpy.sX));e=d.pxpy.sX/a;b=d.pxpy.pX/d.pxpy.pT;h=(2*d.pxpy.pY)/(d.pxpy.pT*d.pxpy.pT);f=d.pxpy.velocity!==undefined&&d.pxpy.velocity>=0?bx.$checkNaN(parseInt(d.pxpy.velocity)):h*d.pxpy.pT}else{if(d.va){if(isNaN(parseInt(d.va.velocity))||isNaN(parseInt(d.va.angle))){bxg.Trace.log("BXG","noProperty","velocity_angle","bxg.WalkerParabolic2D.set");bxg.Trace.data(d.va);return}h=d.va.gravity||9.8;b=d.va.velocity*Math.cos(((360-d.va.angle+90)*Math.PI)/180)*a;f=d.va.velocity*Math.sin(((360-d.va.angle+90)*Math.PI)/180)}else{if(d.vg){if(isNaN(parseInt(d.vg.velocity))){bxg.Trace.log("BXG","noProperty","velocity_gravity","bxg.WalkerParabolic2D.set");bxg.Trace.data(d.vg);return}b=bx.$checkNaN(parseInt(d.vg.dX));h=d.vg.gravity||1;h=2*h*9.8;f=d.vg.velocity||0}else{b=bx.$checkNaN(parseInt(d.dX));h=d.gravity||1;h=2*h*9.8;f=d.velocity||0}}}g.data.$HtE=g.data.$HtE||{motion:{}};g.data.$HtE.motion.velocity=f;g.data.$HtE.motion.gravity=h;g.data.$HtE.motion.dX=b;g.data.$HtE.motion.dTime=a;g.data.$HtE.$75=e;g.data.$HtE.$C6=0;g.data.$HtE.$C7=0;g.data.$HtE.$Hs6=c;return};bxg.WalkerParabolic2D.move=function(b,a){b.data.$HtE.$C6=b.data.$HtE.motion.velocity*b.data.$HtE.$75-0.5*b.data.$HtE.motion.gravity*b.data.$HtE.$75*b.data.$HtE.$75;b.data.$HtE.$92=-Math.floor(b.data.$HtE.$C6-b.data.$HtE.$C7);if(b.data.$HtE.$Hs6){b.data.$HtE.$Hs6.x=0;b.data.$HtE.$Hs6.y=0}if(a&&a.collision==0){if(b.data.$HtE.$92<0||(b.data.$HtE.$75&&b.data.$HtE.$92==0)){if(b.$79&&b.$79.onWalkerEnd){b.$79.onWalkerEnd(b,bxg.game.$9J)}return}}else{if(a&&a.collision==4){if(b.data.$HtE.$92>0||(b.data.$HtE.$75&&b.data.$HtE.$92==0)){if(b.$79&&b.$79.onWalkerEnd){b.$79.onWalkerEnd(b,bxg.game.$9J)}return}}}if(a&&a.collision==2){if(b.data.$HtE.motion.dX<0){b.data.$HtE.motion.dX=0}}else{if(a&&a.collision==6){if(b.data.$HtE.motion.dX>0){b.data.$HtE.motion.dX=0}}}b.data.$HtE.$C7=b.data.$HtE.$C6;b.data.$HtE.$75+=b.data.$HtE.motion.dTime;if(b.data.$HtE.$Hs6){b.data.$HtE.$Hs6.x=b.data.$HtE.motion.dX;b.data.$HtE.$Hs6.y=b.data.$HtE.$92}else{b.moveBy(b.data.$HtE.motion.dX,b.data.$HtE.$92)}};bxg.CInputDevice=function(b,a){if(bx.inClassing){return}this.$DF=a||{};this.$6F={};if(b){for(var c in b){this.$6F[c]={};if(b[c]!="event"&&b[c]!="polling"){bxg.Trace.log("BXG","errorParameter","Invalid event type for map["+c+"]="+b[c],"bxg.CInputDevice");return}this.$6F[c].type=b[c]}}this.$6G=false};bxg.CInputDevice.prototype.$6M=function(a){if(this.$6G){return this.$6F}else{return null}};bxg.CInputDevice.prototype.$6N=function(a){if(this.$6G){this.$6G=false;for(var b in this.$6F){if(this.$6F[b].type=="event"){this.$6F[b].status="off";this.$6F[b].fired=false}else{if(this.$6F[b].type=="polling"&&this.$6F[b].fired){this.$6G=true}}}}};bxg.CInputDevice.prototype.$6L=function(a){if(!this.$DF.multi){for(var b in this.$6F){if(this.$6F[b].type=="polling"){this.$6F[b].status="off";this.$6F[b].fired=false;this.$6G=true}}}if(this.$6F[a]){this.$6F[a].status="on";this.$6F[a].fired=true;this.$6G=true}};bxg.CInputDevice.prototype.$6K=function(a){if(!this.$DF.multi){for(var b in this.$6F){if(this.$6F[b].type=="polling"){this.$6F[b].status="off";this.$6F[b].fired=false;this.$6G=true}}}else{this.$6F[a].status="off";this.$6F[a].fired=false}};bxg.CKeyDevice=function(f,d){if(bx.inClassing){return}if(!f||typeof f!="object"){bxg.Trace.log("BXG","errorParameter","Invalid map="+f,"bxg.CKeyDevice");return}var c={};for(var e in f){c[e]=f[e].type}bxg.CInputDevice.call(this,c,d);this.$6H={"-1":"keyErrorIME","37":"keyLeft","39":"keyRight","38":"keyUp","40":"keyDown","32":"keySpace","65":"keyA","66":"keyB","67":"keyC","68":"keyD","69":"keyE","70":"keyF","71":"keyG","72":"keyH","73":"keyI","74":"keyJ","75":"keyK","76":"keyL","77":"keyM","78":"keyN","79":"keyO","80":"keyP","81":"keyQ","82":"keyR","83":"keyS","84":"keyT","85":"keyU","86":"keyV","87":"keyW","88":"keyX","89":"keyY","90":"keyZ"};this.$6I=f;var g=this;function b(h){if(!h){h=window.event}if(h.keyCode==g.$Ho&&h.keyCode==229){g.$Ho=undefined;for(var i in g.$6I){if(g.$6I[i].key=="keyErrorIME"){g.$6L(i);break}}}else{g.$Ho=h.keyCode;if(g.$6H[String(h.keyCode)]){for(var i in g.$6I){if(g.$6I[i].key==g.$6H[String(h.keyCode)]){g.$6L(i);break}}}}}function a(h){if(!h){h=window.event}if(g.$6H[String(h.keyCode)]){for(var i in g.$6I){if(g.$6I[i].key==g.$6H[String(h.keyCode)]){g.$6K(i);break}}}}bx.Event.add(document,"keydown",b,false);bx.Event.add(document,"keyup",a,false)};bx.$Inherit(bxg.CKeyDevice,bxg.CInputDevice);bxg.CTapDevice=function(e,a){if(bx.inClassing){return}var b={};if(!e||typeof e!="object"){bxg.Trace.log("BXG","errorParameter","Invalid tapmap="+e,"bxg.CTapDevice");return}for(var d in e){b[d]=e[d].type}bxg.CInputDevice.call(this,b);this.$6J=e;this.$6T=a||bxg.playGround;var h=this;var g={x:0,y:0};function c(i){if(!i){i=window.event}g.x=i.targetTouches[0].clientX-bx.HCL.$0C(bxg.playGround);g.y=i.targetTouches[0].clientY-bx.HCL.$0D(bxg.playGround);h.$6L(h.$7y(g))}function f(i){if(!i){i=window.event}h.$6K(h.$7y(g))}bx.Event.add(this.$6T,"touchstart",c,false);bx.Event.add(this.$6T,"touchend",f,false);bx.Event.add(this.$6T,"touchcancel",f,false)};bx.$Inherit(bxg.CTapDevice,bxg.CInputDevice);bxg.CTapDevice.prototype.$7y=function(a){for(var b in this.$6J){if(bxg.Geometry.intersect_point_rect(a,this.$6J[b].area)){return b}}};bxg.CTouchArrowKeyDevice=function(b,k,l){if(bx.inClassing){return}var f={};for(var g in b){f[g]=b[g].type}bxg.CInputDevice.call(this,f,k);this.$93=b;this.$6T=l||bxg.playGround;var e=this;var h={x:0,y:0},j={};var g;var d;function c(m){if(!m){m=window.event}h.x=m.targetTouches[0].clientX-bx.HCL.$0C(bxg.playGround);h.y=m.targetTouches[0].clientY-bx.HCL.$0D(bxg.playGround)}function a(m){if(!m){m=window.event}j.x=(m.targetTouches[0].clientX-bx.HCL.$0C(bxg.playGround))-h.x;j.y=(m.targetTouches[0].clientY-bx.HCL.$0D(bxg.playGround))-h.y;for(g in e.$93){d=false;if(e.$93[g].offset&&e.$93[g].offset.x){if(e.$93[g].offset.x<0&&j.x<e.$93[g].offset.x){d=true}else{if(e.$93[g].offset.x>0&&j.x>e.$93[g].offset.x){d=true}}}else{if(e.$93[g].offset&&e.$93[g].offset.y){if(e.$93[g].offset.y<0&&j.y<e.$93[g].offset.y){d=true}else{if(e.$93[g].offset.y>0&&j.y>e.$93[g].offset.y){d=true}}}}if(d){e.$6L(g)}else{e.$6K(g)}}}function i(m){if(!m){m=window.event}for(g in e.$93){e.$6K(g)}}bx.Event.add(this.$6T,"touchstart",c,false);bx.Event.add(this.$6T,"touchmove",a,false);bx.Event.add(this.$6T,"touchend",i,false);bx.Event.add(this.$6T,"touchcancel",i,false)};bx.$Inherit(bxg.CTouchArrowKeyDevice,bxg.CInputDevice);bxg.CDragDevice=bxg.CTouchArrowKeyDevice;bxg.CAccelerometerDevice=function(a,c){if(bx.inClassing){return}var b={};for(var d in a){b[d]=a[d].type}bxg.CInputDevice.call(this,b,c);this.$93=a};bx.$Inherit(bxg.CAccelerometerDevice,bxg.CInputDevice);bxg.CAccelerometerDevice.prototype.$6M=function(a){var d=this;function b(e){d.$94=e}function c(){}bxg.g.bxgAccelerometer=bxg.g.bxgAccelerometer||new bx.Accelerometer({layer:{api:bx.OEM.detectLayer()}});if(bxg.g.bxgAccelerometer.isSupport){bxg.g.bxgAccelerometer.getCurrentAcceleration(b,c)}if(this.$94){for(this.$95 in this.$93){if(this.$93[this.$95].x&&this.$93[this.$95].x.min!==undefined&&this.$93[this.$95].x.max!==undefined){if(this.$94.x>this.$93[this.$95].x.min&&this.$94.x<this.$93[this.$95].x.max){this.$6L(this.$95)}else{this.$6K(this.$95)}}else{if(this.$93[this.$95].y&&this.$93[this.$95].y.min!==undefined&&this.$93[this.$95].y.max!==undefined){if(this.$94.y>this.$93[this.$95].y.min&&this.$94.y<this.$93[this.$95].y.max){this.$6L(this.$95)}else{this.$6K(this.$95)}}}}}return bxg.CInputDevice.prototype.$6M.call(this,a)};bxg.CAccelerometerDevice.prototype.$6N=function(a){bxg.CInputDevice.prototype.$6N.call(this,a)};bxg.CSound=function(b,g,c,d,a){if(bx.inClassing){return}this.$96=b;this.$97=null;this.$73=g;this.$AU=c||"sound";this.$AV=d;this.$AI=a;if(window.Waper&&window.Waper.Media){this.$97=Waper.Media.open(this.$96)}else{if(bx.OEM.detectLayer()){bxg.$98=bxg.$98||new bx.Audio({layer:{api:bx.OEM.detectLayer()}})}else{bxg.Trace.log("BXG","debug","Cannot detect layer. bxg.CSound will try to use Audio Tag.","bxg.CSound");try{var h=new Audio()}catch(f){bxg.Trace.log("BXG","error","Not support Audio Tag.","bxg.CSound");return}bxg.$98=bxg.$98||new bx.Audio({layer:{api:"google"}})}if(!this.$97&&bxg.$98.isSupport){this.$97=bxg.$98.load(this.$96,{type:this.$AU,looping:this.$AI})}}};bxg.CSound.prototype.$AW=function(a){if(!a||!a.isSupport){return false}if(!this.$AV){return true}else{if(a.supportChannel(this.$AU)>=this.$AV){return true}}return false};bxg.CSound.prototype.$AX=function(a){if(!a||!a.isSupport){return false}if(a.supportChannel("looping")){return true}return false};bxg.CSound.prototype.playBGM=function(){if(this.$AX(bxg.$98)){this.play(true)}else{var b=this;function a(){if(bx.OEM.detectLayer()=="wac2"){b.$97.src=b.$96}b.play()}a();if(this.$73){this.$75=setInterval(a,this.$73)}}};bxg.CSound.prototype.play=function(a){if(this.$AI){a=true}if(window.Waper&&window.Waper.Media){Waper.Media.play(this.$97)}else{if(this.$AW(bxg.$98)){if(bxg.$98){if(this.$97){bxg.$98.play(this.$97,a?{looping:true}:undefined)}}}}};bxg.CSound.prototype.stop=function(){if(!this.$97){return}if(window.Waper&&window.Waper.Media){Waper.Media.pause(this.$97)}else{if(this.$AW(bxg.$98)){if(bxg.$98){bxg.$98.stop(this.$97)}}}if(this.$75!==undefined){clearInterval(this.$75);delete this.$75}};bxg.ObjectFactory={$Hl:1};bxg.ObjectFactory.$7C=function(){if(this.$E2){delete this.$E2}this.$E2={}};bxg.ObjectFactory.register=function(b,e,d){if(b.id&&!b.type){b.type=b.id}if(!b.type){bxg.Trace.log("BXG","noProperty","type="+b.type,"ObjectFactory.register");return false}if(!b.info&&!b.factory){bxg.Trace.log("BXG","noProperty","Object type="+b.type+" info="+b.info+",factory="+b.factory,"ObjectFactory.register");return false}if(bxg.$6c[b.type]){if(!d){bxg.Trace.log("BXG","warnObjectTypeExist",b.type,"ObjectFactory.register")}return false}bxg.$6c[b.type]=b;if(b.options){if(b.options.manager){b.manager=b.options.manager}}if(typeof b.manager=="string"){if(bxg.objectMgrs[b.manager]){b.manager=bxg.objectMgrs[b.manager]}else{bxg.Trace.log("BXG","unknownObjectMgr",b.manager,"ObjectFactory.register");b.manager=null}}if(e){if(!b.imagePath){b.imagePath=bxg.module.$B2()+"imgs/"+b.type}}if(b.className=="bxg.CImageObject"){b.images={};b.images[b.type]={url:b.info}}if(b.images){if(b.imagePath&&bxg.$C9){b.imagePath=bxg.module.applyPath(bxg.$C9,b.imagePath)}else{if(!b.imagePath&&bxg.$C9){b.imagePath=bxg.$C9+"/imgs/"+b.type}}var c={};for(var a in b.images){if(b.imagePath){b.images[a].url=b.imagePath+"/"+b.images[a].url}if(b.$Hd||b.factory){c[b.type+"_"+a]=b.images[a]}else{c[a]=b.images[a]}}b.images=c;delete b.imagePath}bxg.$6c[b.type].ref=0;return true};bxg.ObjectFactory.get=function(a){if(!bxg.$6c[a]){bxg.Trace.log("BXG","unknownObject",a,"ObjectFactory.get")}return bxg.$6c[a]};bxg.ObjectFactory.$HA=function(a){return bxg.$6c[a]};bxg.ObjectFactory.build=function(c,d,g,b){var f=bxg.ObjectFactory.get(c);if(!f){bxg.Trace.log("BXG","unknownObject",c,"ObjectFactory.build");return null}var e;if(f.factory){if(!(e=this.$E0(c))){e=f.factory(c,f.ref,d,g,{type:c});e.type=c}}else{if(!(e=this.$E0(c,f,d))){var h=bx.$copyObject({},f.options);bx.$copyObject(h,bx.$copyObject({},d));switch(f.className){case undefined:case"bxg.CObject":e=new bxg.CObject(c,f.info,h).create();e.type=c;break;case"bxg.CCompositeObject":e=new bxg.CCompositeObject(c,f.info,h).create();e.type=c;break;case"bxg.CImageObject":e=new bxg.CImageObject(c,h);break;default:bxg.Trace.log("BXG","unknownClass",f.className,"ObjectFactory.build");break}if(g){b=g}}}if(e){f.ref++;var a;if(f.configure){a=f.configure(e,f.ref)}else{if(f.config){a=f.config}}if(a){bx.$copyObject(e.data,a)}if(b){bx.$copyObject(e.data,b)}if(bxg.Inspector.$DV){bxg.Inspector.$E1.OF.cBuilt++}}else{if(bxg.Inspector.$DV){bxg.Inspector.$E1.OF.cBuiltErr++}}if(e){f.$H3=f.$9W||{w:e.size.w,h:e.size.h}}return e};bxg.ObjectFactory.intoNameSpace=function(a,b){return a.type+"_"+b};bxg.ObjectFactory.load=function(c,d){if(typeof c=="string"){c=[c]}var e={};var a;for(var b=0;b<c.length;b++){if(!bxg.ObjectFactory.get(c[b])){continue}if(bxg.$6c[c[b]].images&&!bxg.$6c[c[b]].$B5){bxg.$6c[c[b]].$B5=true;for(a in bxg.$6c[c[b]].images){e[a]=bxg.$6c[c[b]].images[a]}}}bxg.imageLoader.load(e,d)};bxg.ObjectFactory.$FW=function(a){if(a&&a.type&&a.$DF.recycle){if(bxg.ObjectFactory.$HA(a.type)){if(!this.$E2[a.type]){this.$E2[a.type]=[]}this.$E2[a.type].push(a);return true}}return false};bxg.ObjectFactory.$E0=function(b,d,c){if(this.$E2[b]&&this.$E2[b].length){var e;if(e=this.$E2[b].shift()){if(e.deactivate){e.deactivate()}if(d){if(!(e instanceof bxg.CImageObject)){var a=bx.$copyObject({},d.options);if(c){bx.$copyObject(a,bx.$copyObject({},c))}e.$DF=a}if(e._initOpt){e._initOpt()}if(e._initSpr){e._initSpr()}}if(e.$DY){e.$DY()}if(e.$79&&e.$79.onInit){e.$79.onInit(e)}e.$FV=false}if(bxg.Inspector.$DV){bxg.Inspector.$E1.RB.cRecycled++}return e}return null};bxg.Inspector={$DV:false,$E1:{OF:{cType:0,cBuilt:0,cBuiltErr:0,},RB:{cType:0,cItem:0,cRecycled:0},LP:{fps:0}},$H5:{$H6:null}};bxg.Inspector.RPT_OF=1;bxg.Inspector.RPT_RB=2;bxg.Inspector.RPT_LP=4;bxg.Inspector.$DW=function(){this.$E3=(new Date()).getTime();this.$E4=bxg.game.$9J};bxg.Inspector.$E5=function(){if(bxg.game&&this.$E3){bxg.Inspector.$E5.$E6=(new Date()).getTime()-this.$E3;if(bxg.Inspector.$E5.$E6>1000){this.$E1.LP.fps=(bxg.game.$9J-this.$E4)/(bxg.Inspector.$E5.$E6/1000)}if(bxg.Inspector.$E5.$E6>10000){bxg.Inspector.$DW()}}};bxg.Inspector.$DX=function(){this.$E3=0};bxg.Inspector.activate=function(){this.$DV=true};bxg.Inspector.$__reset=function(){this.$H5.$H6=null;for(bxg.Inspector.$__reset.$9S in this.$E1.OF){this.$E1.OF[bxg.Inspector.$__reset.$9S]=0}this.$E1.RB.cRecycled=0;this.$DX()};bxg.Inspector.report=function(a){if(!bxg.game){return}if(!a){a=bxg.Inspector.RPT_OF|bxg.Inspector.RPT_RB|bxg.Inspector.RPT_LP}if(a&bxg.Inspector.RPT_LP){this.$E5()}if(a&bxg.Inspector.RPT_OF){this.$E1.OF.cType=0;for(bxg.Inspector.report.$9S in bxg.$6c){this.$E1.OF.cType++}}if(a&bxg.Inspector.RPT_RB){this.$E1.RB.cType=0;this.$E1.RB.cItem=0;for(bxg.Inspector.report.$9S in bxg.ObjectFactory.$E2){this.$E1.RB.cType++;this.$E1.RB.cItem+=bxg.ObjectFactory.$E2[bxg.Inspector.report.$9S].length}}return this.$E1};bxg.Inspector.createConsole=function(b){if(!bxg.game){bxg.Trace.log("BXG","warning","BXG is not properly initialized yet.","Inspector.createConsole");return null}this.$Ht2=b||{dir:"vertical",consolePerformance:true};this.$Ht3=document.body.$TAG("DIV",{style:"position:absolute;top:0px;right:0px;z-index:1;width:200px;background-color:#112211;color:#bbbbbb;padding:4px;border:solid 1px #cccccc"},{boxSizing:"border-box"});if(this.$Ht2.consolePerformance||this.$Ht2.consolePerformanceFull){this.$Ht4=this.$Ht3.$TAG("DIV",{},{width:"100%"});this.$Ht5=this.$Ht4.$TAG("DIV",{style:"width:100%;height:20px;border-bottom:solid 1px #cccccc"},{boxSizing:"border-box"});if(this.$Ht2.consolePerformanceFull){this.$Ht6=this.$Ht4.$TAG("CANVAS",{},{width:"100%",height:"50px"});this.$Ht6.width=this.$Ht6.offsetWidth;this.$Ht6.height=this.$Ht6.offsetHeight;this.$Ht7=0}}var c=this;bxg.Inspector.$DW();function a(){c.$Ht8()}setInterval(a,2000);this.$DV=true;return this.$Ht3};bxg.Inspector.hideConsole=function(){if(this.$Ht3){this.$Ht3.style.display="none";this.$DV=false}else{bxg.Trace.log("BXG","warning","Inspector console is not created yet","Inspector.hideConsole")}};bxg.Inspector.showConsole=function(){if(this.$Ht3){this.$Ht3.style.display="block";this.$DV=true}else{bxg.Trace.log("BXG","warning","Inspector console is not created yet","Inspector.showConsole")}};bxg.Inspector.$Ht8=function(){if(!this.$DV){return}if(this.$Ht5){this.$E5();this.$Ht5.innerHTML='<span style="color:#dddd00">'+Number(this.$E1.LP.fps).toFixed(1)+"</span>/"+Math.round(1000/bxg.game.tickInterval)+'fps R<span style="color:#00dddd">'+this.$E1.LP.msOR+'</span>ms C<span style="color:#00dd00">'+this.$E1.LP.msICC+"</span>ms"}if(this.$Ht6){this.$HtF=this.$HtF||{$HtG:null};var a=this.$Ht6.getContext("2d");a.lineWidth=1;if(this.$Ht7>this.$Ht6.width-1){this.$Ht7=0}if(this.$Ht7==0){a.clearRect(0,0,this.$Ht6.width,this.$Ht6.height);a.beginPath();a.strokeStyle="#dddd00";a.moveTo(0,parseInt(this.$Ht6.height*(1-0.7))+0.5);a.lineTo(this.$Ht6.width,parseInt(this.$Ht6.height*(1-0.7))+0.5);a.stroke()}var b=this.$Ht6.height*0.7-(this.$Ht6.height*0.7)*(this.$E1.LP.fps/(1000/bxg.game.tickInterval));a.beginPath();if(b<-1){a.strokeStyle="#ff4444";a.moveTo(this.$Ht7+0.5,this.$Ht6.height*(1-0.7)+b);a.lineTo(this.$Ht7+0.5,this.$Ht6.height*(1-0.7))}else{if(b>1){a.strokeStyle="#4444ff";a.moveTo(this.$Ht7+0.5,this.$Ht6.height*(1-0.7)+1);a.lineTo(this.$Ht7+0.5,this.$Ht6.height*(1-0.7)+b)}}a.stroke();if(this.$E1.LP.msOR){var c=this.$E1.LP.msOR/(this.$E1.LP.msOR+this.$E1.LP.msICC);a.beginPath();a.strokeStyle="#00dddd";if(this.$HtF.$HtG!==null){a.moveTo(this.$Ht7-1+0.5,parseInt(this.$Ht6.height-this.$Ht6.height*0.4*this.$HtF.$HtG)+0.5)}else{a.moveTo(this.$Ht7+0.5,parseInt(this.$Ht6.height-this.$Ht6.height*0.4*c)+0.5)}a.lineTo(this.$Ht7+0.5,parseInt(this.$Ht6.height-this.$Ht6.height*0.4*c)+0.5);a.stroke();this.$HtF.$HtG=c}this.$Ht7++}};bxg.Inspector.TRC_OBJECT=1;bxg.Inspector.setTrace=function(b,a){if(b instanceof bxg.CObject){this.$H5.$H6=b.id}if(typeof b=="string"){if(!a||a==bxg.Inspector.TRC_OBJECT){this.$H5.$H6=b}}return true};bxg.Inspector.clearTrace=function(a){if(!a||a==bxg.Inspector.TRC_OBJECT){this.$H5.$H6=null}};bxg.Inspector.$H7=function(b,a){if(!a||a==bxg.Inspector.TRC_OBJECT){bxg.Trace.log("BXG","debug","TRACE: CObject("+this.$H5.$H6+") "+b,"bxg.Inspector")}};bxg.$GI=1;bxg.$EV=2;bxg.$FT=1;bxg.$7t=2;bxg.$7u=4;bxg.$6t=1;bxg.$6u=2;bxg.$EU=1;bxg.$FI=2;bxg.$7c=10;bxg.$7d=11;bxg.$7b=12;bxg.$7e=13;bxg.$7a=20;bxg.$6z=21;bxg.$6x=30;bxg.version="1.0.0";bxg.$Hp=false;bxg.CObjectPool=function(){this.objects=[]};bxg.CObjectPool.prototype.add=function(a){this.objects.push(a);return this};bxg.CObjectPool.prototype.searchFree=function(){for(var a=0;a<this.objects.length;a++){if(!this.objects[a].active){return this.objects[a]}}return null};bxg.CObjectPool.prototype.getFree=bxg.CObjectPool.prototype.searchFree;bxg.CObjectPool.prototype.addToControl=function(b){if(this.$7R==b){return}this.$7R=b;for(var a=0;a<this.objects.length;a++){this.objects[a].deactivate();b.add(this.objects[a])}};bxg.CObjectPool.prototype.addToLevel=bxg.CObjectPool.prototype.addToControl;bxg.CObjectPool.prototype.deactivate=function(){for(var a=0;a<this.objects.length;a++){this.objects[a].deactivate()}};bxg.Easing={};bxg.Easing.linear=function(e,a,g,f){return a+(g-a)*e/f};bxg.Easing.inQuad=function(e,a,g,f){return g*(e/=f)*e+a};bxg.Easing.outQuad=function(e,a,g,f){return e>f?g:(-g*(e/=f)*(e-2)+a)};bxg.Easing.inOutQuad=function(e,a,g,f){if(e>f){return g}if((e/=f/2)<1){return g/2*e*e+a}return -g/2*((--e)*(e-2)-1)+a};bxg.Easing.outInQuad=function(e,a,g,f){if(e<f/2){return bxg.Easing.outQuad(e*2,a,g/2,f)}return bxg.Easing.inQuad((e*2)-f,a+g/2,g/2,f)};bxg.Easing.inCubic=function(e,a,g,f){return g*(e/=f)*e*e+a};bxg.Easing.outCubic=function(e,a,g,f){return e>f?g:g*((e=e/f-1)*e*e+1)+a};bxg.Easing.inOutCubic=function(e,a,g,f){if(e>f){return g}if((e/=f/2)<1){return g/2*e*e*e+a}return g/2*((e-=2)*e*e+2)+a};bxg.Easing.outInCubic=function(e,a,g,f){if(e<f/2){return bxg.Easing.outCubic(e*2,a,g/2,f)}return bxg.Easing.inCubic((e*2)-f,a+g/2,g/2,f)};bxg.Easing.inQuart=function(e,a,g,f){return g*(e/=f)*e*e*e+a};bxg.Easing.outQuart=function(e,a,g,f){return e>f?g:-g*((e=e/f-1)*e*e*e-1)+a};bxg.Easing.inOutQuart=function(e,a,g,f){if(e>f){return g}if((e/=f/2)<1){return g/2*e*e*e*e+a}return -g/2*((e-=2)*e*e*e-2)+a};bxg.Easing.outInQuart=function(e,a,g,f){if(e<f/2){return bxg.Easing.outQuart(e*2,a,g/2,f)}return bxg.Easing.inQuart((e*2)-f,a+g/2,g/2,f)};bxg.Geometry={};bxg.Geometry.intersect_point_point=function(b,a){return(b.x==a.x)&&(b.y==a.y)};bxg.Geometry.intersect_point_rect=function(a,b){return(a.x>=b.x&&a.x<(b.x+b.w))&&(a.y>=b.y&&a.y<(b.y+b.h))};bxg.Geometry.intersect_rect_point=function(b,a){return bxg.Geometry.intersect_point_rect(a,b)};bxg.Geometry.intersect_point_circle=function(a,b){return((b.x-a.x)*(b.x-a.x)+(b.y-a.y)*(b.y-a.y))<=b.r*b.r};bxg.Geometry.intersect_circle_point=function(b,a){return bxg.Geometry.intersect_point_circle(a,b)};bxg.Geometry.intersect_rect_rect=function(b,a){return(((b.x>=a.x&&b.x<(a.x+a.w))||(b.x<a.x&&(b.x+b.w)>a.x))&&((b.y>=a.y&&b.y<(a.y+a.h))||(b.y<a.y&&(b.y+b.h)>a.y)))};bxg.Geometry.intersect_rect_circle=function(a,b){bxg.Geometry.$7z=Math.abs(b.x-(a.x+a.w/2));bxg.Geometry.$8a=Math.abs(b.y-(a.y+a.h/2));if(bxg.Geometry.$7z>(a.w/2+b.r)){return false}if(bxg.Geometry.$8a>(a.h/2+b.r)){return false}if(bxg.Geometry.$7z<=(a.w/2)){return true}if(bxg.Geometry.$8a<=(a.h/2)){return true}return Math.pow(bxg.Geometry.$7z-a.w/2,2)+Math.pow(bxg.Geometry.$8a-a.h/2,2)<=Math.pow(b.r,2)};bxg.Geometry.intersect_circle_rect=function(b,a){return bxg.Geometry.intersect_rect_circle(a,b)};bxg.Geometry.intersect_circle_circle=function(b,a){if(Math.pow(a.x-b.x,2)+Math.pow(a.y-b.y,2)<Math.pow(b.r+a.r,2)){return true}else{return false}};bxg.Geometry.intersect_line_line=function(d,b,c,a){bxg.Geometry.$Hs7=b.y-d.y;bxg.Geometry.$Hs8=d.x-b.x;bxg.Geometry.$Hs9=b.x*d.y-d.x*b.y;bxg.Geometry.$HsA=bxg.Geometry.$Hs7*c.x+bxg.Geometry.$Hs8*c.y+bxg.Geometry.$Hs9;bxg.Geometry.$HsF=bxg.Geometry.$Hs7*a.x+bxg.Geometry.$Hs8*a.y+bxg.Geometry.$Hs9;if(bxg.Geometry.$HsA!=0&&bxg.Geometry.$HsF!=0&&bxg.Geometry.$HsA*bxg.Geometry.$HsF>=0){return false}bxg.Geometry.$HsB=a.y-c.y;bxg.Geometry.$HsC=c.x-a.x;bxg.Geometry.$HsD=a.x*c.y-c.x*a.y;bxg.Geometry.$HsE=bxg.Geometry.$HsB*d.x+bxg.Geometry.$HsC*d.y+bxg.Geometry.$HsD;bxg.Geometry.$HsG=bxg.Geometry.$HsB*b.x+bxg.Geometry.$HsC*b.y+bxg.Geometry.$HsD;if(bxg.Geometry.$HsE!=0&&bxg.Geometry.$HsG!=0&&bxg.Geometry.$HsE*bxg.Geometry.$HsG>=0){return false}bxg.Geometry.$HsH=bxg.Geometry.$Hs7*bxg.Geometry.$HsC-bxg.Geometry.$HsB*bxg.Geometry.$Hs8;if(bxg.Geometry.$HsH==0){return false}return true};bxg.CObject.$G0={point_point:bxg.Geometry.intersect_point_point,point_rect:bxg.Geometry.intersect_point_rect,rect_point:bxg.Geometry.intersect_rect_point,point_circle:bxg.Geometry.intersect_point_circle,circle_point:bxg.Geometry.intersect_circle_point,rect_rect:bxg.Geometry.intersect_rect_rect,rect_circle:bxg.Geometry.intersect_rect_circle,circle_rect:bxg.Geometry.intersect_circle_rect,circle_circle:bxg.Geometry.intersect_circle_circle};bxg.Geometry.collision_circle_circle=function(c,b,a){a=a||{};a.dist=Math.sqrt(Math.pow(b.x-c.x,2)+Math.pow(b.y-c.y,2));if(a.dist<c.r+b.r){return true}else{return false}};bxg.Geometry.getAngle=function(b,a,c){if(c){return(Math.atan2(a.x-b.x,b.y-a.y)+2*Math.PI)%(2*Math.PI)}else{return bxg.Geometry.getRadToDeg((Math.atan2(a.x-b.x,b.y-a.y)+2*Math.PI)%(2*Math.PI))}};bxg.Geometry.getDegToRad=function(a){return a*Math.PI/180};bxg.Geometry.getRadToDeg=function(a){return a*180/Math.PI};bxg.Geometry.getDistance=function(b,a){return Math.sqrt(Math.pow(a.x-b.x,2)+Math.pow(a.y-b.y,2))};bxg.Geometry.$HP=function(d,c,b){b=b||{};b.x=b.y=0;b.w=d.w;b.h=d.h;var a,e;a=Math.cos(-c*2*Math.PI/360)*(-d.w/2)-Math.sin(-c*2*Math.PI/360)*(-d.h/2);e=Math.sin(-c*2*Math.PI/360)*(-d.w/2)+Math.cos(-c*2*Math.PI/360)*(-d.h/2);if(a<b.x){b.x=a}if(a>b.w){b.w=a}if(e<b.y){b.y=e}if(e>b.h){b.h=e}a=Math.cos(-c*2*Math.PI/360)*(d.w/2)-Math.sin(-c*2*Math.PI/360)*(-d.h/2);e=Math.sin(-c*2*Math.PI/360)*(d.w/2)+Math.cos(-c*2*Math.PI/360)*(-d.h/2);if(a<b.x){b.x=a}if(a>b.w){b.w=a}if(e<b.y){b.y=e}if(e>b.h){b.h=e}a=Math.cos(-c*2*Math.PI/360)*(-d.w/2)-Math.sin(-c*2*Math.PI/360)*(d.h/2);e=Math.sin(-c*2*Math.PI/360)*(-d.w/2)+Math.cos(-c*2*Math.PI/360)*(d.h/2);if(a<b.x){b.x=a}if(a>b.w){b.w=a}if(e<b.y){b.y=e}if(e>b.h){b.h=e}a=Math.cos(-c*2*Math.PI/360)*(d.w/2)-Math.sin(-c*2*Math.PI/360)*(d.h/2);e=Math.sin(-c*2*Math.PI/360)*(d.w/2)+Math.cos(-c*2*Math.PI/360)*(d.h/2);if(a<b.x){b.x=a}if(a>b.w){b.w=a}if(e<b.y){b.y=e}if(e>b.h){b.h=e}b.w=Math.round(b.w-b.x);b.h=Math.round(b.h-b.y);b.x=Math.round(b.x+d.w/2);b.y=Math.round(b.y+d.h/2);return b};bxg.Canvas=bxg.Canvas||{};bxg.Canvas.drawImage=function(e,b,g,f,i,d,k,c){if(k!==undefined||c!==undefined){e.save();var a=i!==undefined?i:b.width;var j=d!==undefined?d:b.height;if(k!==undefined){e.translate(g+a/2,f+j/2);e.rotate(k*Math.PI/180);e.drawImage(b,-a/2,-j/2,a,j)}else{if(c!==undefined){if(c==90){e.setTransform(-1,0,0,1,g+a,f)}else{if(c==180){e.setTransform(-1,0,0,-1,g+a,f+j)}else{if(c==270){e.setTransform(1,0,0,-1,g,f+j)}else{e.setTransform(1,0,0,1,g,f)}}}e.drawImage(b,0,0)}}e.restore()}else{if(i!==undefined&&d!==undefined){e.drawImage(b,g,f,i,d)}else{e.drawImage(b,g,f)}}};bxg.Canvas.drawImagePattern=function(b,e,a,f,c,d){e.$8b=e.$8b||b.createPattern(e,"repeat");if(a||f){b.save();b.translate(a,f)}b.rect(0,0,c-a,d-f);b.fillStyle=e.$8b;b.fill();if(a||f){b.restore()}};bxg.Trace=new bx.CTrace();bxg.Trace.error={debug:{$AZ:1001,$B0:""},warning:{$AZ:2001,$B0:""},warnEmptyArray:{$AZ:2002,$B0:"Empty array is iterated"},warnDeviceCapability:{$AZ:2003,$B0:"Device doesn't support this function"},warnInvalidState:{$AZ:5008,$B0:"Can't perform work for invalid state:"},warnObjectNoControl:{$AZ:2101,$B0:"Object(not belongs to any CControl) is tried to "},warnObjectTypeExist:{$AZ:2102,$B0:"Already existed Object type is tried to register"},warnObjectUnloaded:{$AZ:2103,$B0:"Unloaded object is tried to activate"},warnAddToTile:{$AZ:2104,$B0:"Fail to add a tile:"},warnNoSprites:{$AZ:2105,$B0:"Object dose not have sprites."},error:{$AZ:5001,$B0:""},unknownClass:{$AZ:5002,$B0:"Unknown Class is instantiated"},noProperty:{$AZ:5003,$B0:"Property is not properly setup"},emptyArrayError:{$AZ:5004,$B0:"Empty array is iterated"},errorParameter:{$AZ:5005,$B0:"Function parameter error"},unknownType:{$AZ:5006,$B0:"Unknown type is referenced"},errorRenderer:{$AZ:5007,$B0:"The current Rendering-mode does not support this module/function:"},errorInvalidState:{$AZ:5008,$B0:"Can't perform work for invalid state:"},unknownSpriteGroup:{$AZ:5101,$B0:"Unknown Sprite Group is referenced"},unknownObject:{$AZ:5102,$B0:"Unknown Object is referenced"},errorImage:{$AZ:5103,$B0:"Image file load failed"},unknownImageId:{$AZ:5104,$B0:"Unknown Image is referenced"},unknownObjectMgr:{$AZ:5105,$B0:"Unknown ObjectManager is referenced"},unknownMapData:{$AZ:5106,$B0:"Unknown MapData is referenced"},errorFringe:{$AZ:5108,$B0:"Missing fringe image"},unknownSpriteId:{$AZ:5109,$B0:"Unknown Sprite Id is referenced"},unknownTile:{$AZ:5110,$B0:"Unknown Tile is referenced"},errorTile:{$AZ:5111,$B0:"There is a problem in Tile data"},errorImport:{$AZ:5112,$B0:"File import is failed"},unknownLevelData:{$AZ:5113,$B0:"Unknown LevelData is referenced"},errorLevelData:{$AZ:5114,$B0:"Format error in LevelData"},noGameLoop:{$AZ:5115,$B0:"Gameloop is not created yet"},errorMapData:{$AZ:5116,$B0:"Format error in MapData"},emptySprite:{$AZ:5117,$B0:"Empty sprite"},errorNaN:{$AZ:5118,$B0:"Given value is not a valid number"}};bxg.$EA={$D9:bxg.$EV,$8u:2};bxg.$EA.$EC=function(a){bxg.$EA.$8c=bxg.$EB.$8c;bxg.$EA.$EZ.prototype.$8d=bxg.$EB.$EZ.prototype.$8d;bxg.$EA.$EZ.prototype.$8e=bxg.$EB.$EZ.prototype.$8e;bxg.$EA.$EZ.prototype.$8f=bxg.$EB.$EZ.prototype.$8f;bxg.$EA.$EZ.prototype.$HsI=bxg.$EB.$EZ.prototype.$HsI;this.$DF=a||{};if((bxg.$9I&bxg.$E8)&&(bxg.$9I&bxg.$E7)){if(bx.HCL.$0a[1]=="chrome"){this.__quirksChromeRefresh=true}}};bxg.$EA.$7l=function(a){if(bxg.$9I&bxg.$E8&&a.$D9&bxg.$7t){return new bxg.$EB.$EH(a)}return new bxg.$EA.$EH(a)};bxg.$EA.$EH=function(a){if(!a){return}this.$DF=a;this.$7g=this.$7h=0;this.$HQ={x:0,y:0,w:0,h:0};if(a.$G2){this.$FO=bx.DOM.overrideElement(a.$G2);this.$FO.style.position="absolute";if(this.$DF.$AZ){this.$FO.$A({name:this.$DF.$AZ})}}else{if(this.$DF.$D9&bxg.$7u){if(this.$DF.$GW){this.$FO=bxg.buffer.$TAG("DIV",this.$DF.$AZ?{name:this.$DF.$AZ}:null,{position:"absolute",display:"none"})}else{}}else{if(this.$Ht9()){this.$FO=bxg.buffer.$TAG("CANVAS",{width:this.$DF.$GW.w,height:this.$DF.$GW.h},{position:"absolute",display:"none"})}else{this.$FO=bxg.buffer.$TAG("IMG");this.$FO.style.position="absolute";this.$FO.style.display="none";if(this.$DF.$AZ){this.$FO.$A({name:this.$DF.$AZ})}}}}this.$FF(a.$GJ,true);this.$FQ(a.$F6);if(a.$GW){this.$HR(a.$GW)}this.$HS(a.$GK)};bxg.$EA.$EH.prototype.$F1=function(){if(this.$FO){if(this.$FO.parentNode){this.$FO.parentNode.removeChild(this.$FO)}delete this.$FO}};bxg.$EA.$EH.prototype.$Ht9=function(){if(this.$DF.$GD&&this.$DF.$GD.$D9==1){if(!(bxg.$9I&bxg.$E8)){return true}else{if(bxg.$9I&bxg.$E8&&bxg.$9I&bxg.$E7&&!(this.$DF.$D9&bxg.$7t)){return true}}}return false};bxg.$EA.$EH.prototype.$FQ=function(a){if(bxg.$9I&bxg.$E8&&this.$DF.$D9&bxg.$7t){bxg.$EB.$EH.prototype.$FQ.call(this,a)}else{this.$DF.$F6=a;if(this.$FO){this.$FO.style.zIndex=a}this.$HT()}};bxg.$EA.$EH.prototype.$HR=function(a){bxg.$EB.$EH.prototype.$HR.call(this,a);if(this.$FO){if(this.$DF.$GW){this.$FO.style.width=Math.round(this.$HQ.w)+"px";this.$FO.style.height=Math.round(this.$HQ.h)+"px"}}};bxg.$EA.$EH.prototype.$HS=function(a){if(!bxg.$EB.$EH.prototype.$HS.call(this,a)){return false}if(this.$FO){if(bx.HCL.DV.supportCSS3()){this.$FO.$CSS({transform:"rotateZ("+this.$DF.$GK+"deg)"})}else{bxg.Trace.log("BXG","warnDeviceCapability","CSS3","RD.SP")}}return true};bxg.$EA.$EH.prototype.$FF=function(b,a){if(!bxg.$EB.$EH.prototype.$FF.call(this,b,a)){return false}if(!this.$FO){return true}if(b.position){bxg.$EA.$EH.prototype.$FF.$GO=b.position.x+"px "+b.position.y+"px";if(!this.$FH){this.$FO.src=bx.c.bx$nullImage}if(!this.$FH){this.$FO.style.width=b.size.w+"px"}if(!this.$FH){this.$FO.style.height=b.size.h+"px"}if(this.$GM!=b.url){this.$FO.style.backgroundImage="url('"+b.url+"')";this.$GM=b.url}if(this.$GN!=bxg.$EA.$EH.prototype.$FF.$GO){this.$FO.style.backgroundPosition=bxg.$EA.$EH.prototype.$FF.$GO;this.$GN=bxg.$EA.$EH.prototype.$FF.$GO}if(bxg.$EA.__quirksChromeRefresh){this.$FO.style.right="0px"}this.$FH=true}else{if(this.$DF.$D9&bxg.$7u){this.$FO.style.backgroundImage="url("+this.$DF.$GJ.url+")"}else{this.$FO.src=b.url}}if(b.opacity!==undefined){this.$FO.$CSS({opacity:b.opacity})}else{if(this.$FO.style.opacity!=1){this.$FO.$CSS({opacity:1})}}return true};bxg.$EA.$EH.prototype.$FY=function(a,b){this.$7g=a;this.$7h=b;if(this.$FO){if(this.$AP&&this.$AP.$DF.$FL){}this.$FO.style.left=Math.round(this.$7g)+"px";this.$FO.style.top=Math.round(this.$7h)+"px"}};bxg.$EA.$EH.prototype.$HT=function(){if(this.$Ht9()){this.$6G=true}bxg.$EB.$EH.prototype.$HT.call(this)};bxg.$EA.$EH.prototype.$HsJ=function(){return this.$AP?true:false};bxg.$EA.$EH.prototype.$F4=function(a){if(this.$DV==a){return}if(this.$FO){if(a){this.$FO.style.display="block"}else{this.$FO.style.display="none"}}if(!(bxg.$9I&bxg.$E8)){if(this.$DF.$D9&bxg.$7u&&!this.$FO){if(this.$AP){switch(this.$AP.$DF.$D9){case bxg.$7c:case bxg.$7d:case bxg.$7b:case bxg.$7e:if(this.$AP.$DF.$FL){if(a){if(this.$AP.$DF.$FL.$6Z[0]){this.$AP.$DF.$FL.$6Z[0].style.backgroundImage="url("+this.$DF.$GJ.url+")";this.$AP.$DF.$FL.$6Z[0].$9v={w:this.$DF.$GJ.w,h:this.$DF.$GJ.h}}if(this.$AP.$DF.$FL.$6Z[1]){this.$AP.$DF.$FL.$6Z[1].style.backgroundImage="url("+this.$DF.$GJ.url+")";this.$AP.$DF.$FL.$6Z[1].$9v={w:this.$DF.$GJ.w,h:this.$DF.$GJ.h}}}else{if(this.$AP.$DF.$FL.$6Z[0]){this.$AP.$DF.$FL.$6Z[0].style.backgroundImage="";if(this.$AP.$DF.$FL.$6Z[0].$9v){delete this.$AP.$DF.$FL.$6Z[0].$9v}}if(this.$AP.$DF.$FL.$6Z[1]){this.$AP.$DF.$FL.$6Z[1].style.backgroundImage="";if(this.$AP.$DF.$FL.$6Z[1].$9v){delete this.$AP.$DF.$FL.$6Z[1].$9v}}}}break;default:if(a){this.$AP.$7J.style.backgroundImage="url("+this.$DF.$GJ.url+")"}else{this.$AP.$7J.style.backgroundImage=""}break}}}}bxg.$EB.$EH.prototype.$F4.call(this,a)};bxg.$EA.$EZ=function(a){if(!a||!a.$D9||!a.$GF||!a.$Hr){bxg.Trace.log("BXG","errorParameter","invalid options","rDOM.LR");return}this.$DF=a;this.$9w=false};bxg.$EA.$EZ.prototype.$F0=function(){this.$7J=this.$DF.$EX;switch(this.$DF.$D9){case bxg.$FI:case bxg.$7a:case bxg.$6z:case bxg.$6x:this.$7J=this.$DF.$EX.$TAG("div",{},{zIndex:this.$DF.$F6+1,position:"absolute",left:"0px",top:"0px",width:this.$DF.$GF.w+"px",height:this.$DF.$GF.h+"px"});break;case bxg.$7c:case bxg.$7d:case bxg.$7b:case bxg.$7e:break}this.$8g=0;this.$8j=0;this.$8h=this.$8g;this.$8i=this.$8j;this.$8k=false;this.$8l=[];if((this.$7J!=this.$DF.$EX)&&!(this.$DF.$6r&bxg.$6t)){this.$HsK=true}};bxg.$EA.$EZ.prototype.$F1=function(){if(this.$GA){this.$GA.parentNode.removeChild(this.$GA);delete this.$GA;delete this.$8m}if(this.$7J!=this.$DF.$EX){this.$7J.parentNode.removeChild(this.$7J);delete this.$7J}delete this.$8l};bxg.$EA.$EZ.prototype.$FJ=function(a){bxg.$EB.$EZ.prototype.$FJ.call(this,a);if(this.$7J!=this.$DF.$EX){this.$7J.style.width=Math.round(this.$DF.$GF.w)+"px";this.$7J.style.height=Math.round(this.$DF.$GF.h)+"px"}if(this.$GA){this.$GA.width=this.$DF.$GF.w;this.$GA.height=this.$DF.$GF.h}};bxg.$EA.$EZ.prototype.$CM=function(a,b){if(this.$HsK){if(a===undefined&&b===undefined){return}if(a==this.$8g&&b==this.$8j){return}if(a!==undefined){this.$8h=this.$8g;this.$8g=a}if(b!==undefined){this.$8i=this.$8j;this.$8j=b}}else{bxg.$EB.$EZ.prototype.$CM.call(this,a,b);this.$8n=true}if(this.$7J!=this.$DF.$EX){if(this.$8g-this.$8h){this.$7J.style.left=Math.round(this.$8g)+"px"}if(this.$8j-this.$8i){this.$7J.style.top=Math.round(this.$8j)+"px"}}};bxg.$EA.$EZ.prototype.$GV=function(b,a){bxg.$EB.$EZ.prototype.$GV.call(this,b,true)};bxg.$EA.$EZ.prototype.$EK=function(){switch(this.$DF.$D9){case bxg.$FI:case bxg.$7a:case bxg.$6z:case bxg.$6x:if(this.$8g-this.$8h){this.$7J.style.left=Math.round(this.$8g)+"px"}if(this.$8j-this.$8i){this.$7J.style.top=Math.round(this.$8j)+"px"}break;case bxg.$7c:case bxg.$7d:case bxg.$7b:case bxg.$7e:if(this.$DF.$FL&&this.$DF.$FL.$7i){this.$DF.$FL.$7i()}break}if(this.$HtA){for(this.$9S=0;this.$9S<this.$HtA.length;this.$9S++){if(this.$HtA[this.$9S].$Ht9()){if(this.$HtA[this.$9S].$6G===undefined||this.$HtA[this.$9S].$6G){this.$HtA[this.$9S].$DF.$GD.$D8=this.$HtA[this.$9S].$DF.$GD.$D8||{};this.$HtA[this.$9S].$DF.$GD.$D8.area=this.$HtA[this.$9S].$DF.$GD.$D8.area||{};this.$HtA[this.$9S].$DF.$GD.$D8.area.x=0;this.$HtA[this.$9S].$DF.$GD.$D8.area.y=0;this.$HtA[this.$9S].$DF.$GD.$D8.area.w=this.$HtA[this.$9S].$HQ.w;this.$HtA[this.$9S].$DF.$GD.$D8.area.h=this.$HtA[this.$9S].$HQ.h;this.$HtA[this.$9S].$FO.getContext("2d").clearRect(0,0,this.$HtA[this.$9S].$FO.width,this.$HtA[this.$9S].$FO.height);this.$HtA[this.$9S].$DF.$GD.$GZ(this.$HtA[this.$9S].$FO.getContext("2d"),this.$HtA[this.$9S].$DF.$GD.$D8);this.$HtA[this.$9S].$6G=false}}}}this.$8o=false;bxg.$EB.$EZ.prototype.$EK.call(this);if(this.$HsK){this.$8s=false}};bxg.$EA.$EZ.prototype.$F8=function(){if(this.$7J!=this.$DF.$EX){this.$7J.style.display="block"}if(this.$GA){this.$GA.style.display="block"}this.$8s=true};bxg.$EA.$EZ.prototype.$F9=function(){if(this.$7J!=this.$DF.$EX){this.$7J.style.display="none"}if(this.$GA){this.$GA.style.display="none"}};bxg.$EA.$EZ.prototype.$F5=function(a){if(a.$FO){this.$7J.appendChild(a.$FO)}if(bxg.$9I&bxg.$E8&&a.$DF.$D9&bxg.$7t){if(!this.$GA){if(this.$HsK){this.$GA=this.$7J.$TAG("canvas",{},{position:"absolute",zIndex:this.$DF.$F6,left:"0px",top:"0px",display:"block"});this.$GA.width=this.$DF.$GF.w;this.$GA.height=this.$DF.$GF.h}else{this.$GA=bxg.$E9.$DF.$8p.$TAG("canvas",{},{position:"absolute",zIndex:this.$DF.$F6,left:"0px",top:"0px",display:"block"});this.$GA.width=this.$DF.$Hr.w;this.$GA.height=this.$DF.$Hr.h}this.$8m=this.$GA.getContext("2d")}bxg.$EB.$EZ.prototype.$F5.call(this,a)}else{if(a.$Ht9()){this.$HtA=this.$HtA||[];this.$HtA.push(a)}}a.$AP=this};bxg.$EA.$EZ.prototype.$F7=function(a){if(a.$F4){a.$F4(false)}if(a.$FO){if(a.$FO.parentNode){a.$FO.parentNode.removeChild(a.$FO)}}if(bxg.$9I&bxg.$E8&&a.$DF.$D9&bxg.$7t){bxg.$EB.$EZ.prototype.$F7.call(this,a)}a.$AP=null};bxg.$EA.$EZ.prototype.$HE=function(a){this.$8s=true};bxg.$EB={$D9:0,$8u:2};bxg.$EB.$EC=function(a){this.$DF=a||{};this.$A8=this.$DF.$8p.$TAG("canvas",{},{position:"absolute",left:"0px",top:"0px",display:"block"});this.$A8.width=this.$DF.$GF.w;this.$A8.height=this.$DF.$GF.h;this.$8r=this.$A8.getContext("2d");this.$8t=[]};bxg.$EB.$EG=function(){if(!this.$8t.length){return}this.$8v=false;for(this.$GY=this.$8t.length-1;this.$GY>=0;this.$GY--){if(bxg.$EB.$8t[this.$GY].$8o||(bxg.$EB.$8t[this.$GY].$8s||bxg.$EB.$8t[this.$GY].$8n)){this.$8v=true}}for(this.$GY=this.$8t.length-1;this.$GY>=0;this.$GY--){if(this.$8v){bxg.$EB.$8t[this.$GY].$8o=true;bxg.$EB.$8t[this.$GY].$8n=true}}if(this.$8v){this.$8r.clearRect(0,0,this.$A8.width,this.$A8.height)}};bxg.$EB.$8c=function(b,a){this.$8w=-1;for(this.$9S=0;this.$9S<b.length;this.$9S++){if(bx.$checkNaN(parseInt(a.$DF.$F6))<bx.$checkNaN(parseInt(b[this.$9S].$DF.$F6))){this.$8w=this.$9S;break}}if(this.$8w==-1){b.push(a)}else{b.splice(this.$8w,0,a)}};bxg.$EB.$7l=function(a){return new bxg.$EB.$EH(a)};bxg.$EB.$EH=function(a){if(!a){return}this.$DF=a;this.$7g=this.$7h=0;this.$HQ={x:0,y:0,w:0,h:0};if(this.$DF.$GD){if(!this.$DF.$GD.$D9){this.$DF.$GD.$D9=1}if(this.$DF.$GD.$D9==1&&!this.$DF.$GW){bxg.Trace.log("BXG","noProperty","Type=1 render sprite requires 'resize' options","render.SPR")}}this.$FF(this.$DF.$GJ,true);this.$FQ(this.$DF.$F6);this.$HR(this.$DF.$GW);this.$HS(this.$DF.$GK)};bxg.$EB.$EH.prototype.$F1=function(){};bxg.$EB.$EH.prototype.$FQ=function(a){this.$DF.$F6=a;if(this.$AP){if(this.$DF.$D9&bxg.$7t){this.$AP.$8l.$HsL=true}else{this.$AP.$9a.$HsL=true}}this.$HT()};bxg.$EB.$EH.prototype.$HR=function(a){if(!a||typeof a!="object"){this.$DF.$GW=undefined}else{this.$DF.$GW=a}if(this.$DF.$GK){this.$HS(this.$DF.$GK)}else{if(this.$DF.$GW){this.$HQ.w=this.$DF.$GW.w;this.$HQ.h=this.$DF.$GW.h}}this.$HT();return true};bxg.$EB.$EH.prototype.$HS=function(a){if(!(a==0||a)){return false}this.$DF.$GK=a;if(this.$DF.$GJ){bxg.Geometry.$HP({x:this.$7g,y:this.$7h,w:this.$DF.$GW?this.$DF.$GW.w:this.$DF.$GJ.w,h:this.$DF.$GW?this.$DF.$GW.h:this.$DF.$GJ.h},a,this.$HQ)}this.$HT();return true};bxg.$EB.$EH.prototype.$FF=function(b,a){if(!a&&this.$DF.$GJ==b){return false}if(!b){return false}if(b.position){this.$HQ.w=b.size.w;this.$HQ.h=b.size.h}else{this.$HQ.w=b.w;this.$HQ.h=b.h}this.$DF.$GJ=b;this.$HT();return true};bxg.$EB.$EH.prototype.$FY=function(a,b){this.$7g=a;this.$7h=b;this.$HT()};bxg.$EB.$EH.prototype.$HT=function(){if(this.$AP){if(this.$AP.$HsI(this)){if(this.$DF.$D9&bxg.$7t){this.$AP.$8s=true}else{this.$AP.$8o=true}}}};bxg.$EB.$EH.prototype.$HsJ=function(){return this.$AP?true:false};bxg.$EB.$EH.prototype.$F4=function(a){if(this.$DV==a){return}this.$DV=a;this.$HT()};bxg.$EB.$EZ=function(a){if(!a||!a.$D9||!a.$GF){bxg.Trace.log("BXG","errorParameter","invalid options","rDOM.LR");return}this.$DF=a};bxg.$EB.$EZ.prototype.$F0=function(){this.$GA=bxg.$E9.$A8;this.$8m=bxg.$E9.$8r;this.$9S=0;this.$8g=0;this.$8j=0;this.$8h=this.$8g;this.$8i=this.$8j;this.$8l=[];this.$9a=[];this.$8s=true;this.$8n=true;this.$8k=false;this.$8o=true;this.$9w=true;bxg.$E9.$8c(bxg.$E9.$8t,this)};bxg.$EB.$EZ.prototype.$F1=function(){delete this.$8l;delete this.$9a;if(this.$8x){this.$FO.parentNode.removeChild(this.$FO);this.$8x.$A8.parentNode.removeChild(this.$8x.$A8);delete this.$8x}for(var a=0;a<bxg.$E9.$8t.length;a++){if(bxg.$E9.$8t[a]==this){bxg.$E9.$8t.splice(a);break}}};bxg.$EB.$EZ.prototype.$FJ=function(a){this.$DF.$GF=a;if(this.$8x){if(this.$8x.$8y){this.$8x.$A8.width=a.w;this.$8x.$A8.height=a.h}if(this.$DF.$GF.w<this.$DF.$Hr.w||this.$DF.$GF.h<this.$DF.$Hr.h){bxg.Trace.log("BXG","error","Map area size is smaller than view screen size.","RD.RA");return}}};bxg.$EB.$EZ.prototype.$CM=function(a,b){if(a===undefined&&b===undefined){return}if(a==this.$8g&&b==this.$8j){return}if(a!==undefined){this.$8h=this.$8g;this.$8g=a}if(b!==undefined){this.$8i=this.$8j;this.$8j=b}if(!this.$8s){this.$8s=this.$8k;if(this.$8x&&this.$8x.$8z){if(this.$8e()){this.$8s=false}}}this.$8o=true};bxg.$EB.$EZ.prototype.$HsI=function(a){this.$9b=this.$9b||{};this.$9c=this.$9c||{};if(a.$DF.$D9&bxg.$7t&&this.$8x){if(this.$8x.$8y){this.$9c.x=0;this.$9c.y=0}else{if(this.$8x.$9g){this.$9c.x=-this.$8g;this.$9c.y=-this.$8j}else{this.$9c.x=this.$8x.$9h.x;this.$9c.y=this.$8x.$9h.y}}this.$9c.w=this.$8x.$A8.width;this.$9c.h=this.$8x.$A8.height}else{this.$9c.x=-this.$8g;this.$9c.y=-this.$8j;this.$9c.w=this.$DF.$Hr.w;this.$9c.h=this.$DF.$Hr.h}this.$9b=this.$9b||{};this.$9b.x=(a.$7g+a.$HQ.x);this.$9b.y=(a.$7h+a.$HQ.y);this.$9b.w=a.$HQ.w;this.$9b.h=a.$HQ.h;return bxg.Geometry.intersect_rect_rect(this.$9b,this.$9c)};bxg.$EB.$EZ.prototype.$GV=function(b,a){this.$9b=this.$9b||{};this.$9c=this.$9c||{};this.$9d=this.$8x&&a?this.$8x.$8r:this.$8m;this.$9e=this.$8g;this.$9f=this.$8j;if(this.$8x&&a){if(this.$8x.$8y){this.$9e=0;this.$9f=0}else{if(this.$8x.$9g){}else{this.$9e=this.$8x.$9h.x;this.$9f=this.$8x.$9h.y}}}if(this.$HsK){this.$9e=0;this.$9f=0}this.$9b.x=-this.$9e;this.$9b.y=-this.$9f;this.$9b.w=this.$9d.canvas.width;this.$9b.h=this.$9d.canvas.height;if(b.$DF.$GJ){if(b.$DF.$GJ.opacity!==undefined){this.$9d.globalAlpha=b.$DF.$GJ.opacity}if(b.$DF.$D9&bxg.$7u){if(b.$DF.$GW){this.$9j=b.$7g+this.$9e;this.$9i=b.$7h+this.$9f}else{this.$9j=this.$9e;this.$9i=this.$9f}bxg.Canvas.drawImagePattern(this.$9d,b.$DF.$GJ.$9M,this.$9j,this.$9i,b.$DF.$GW?b.$DF.$GW.w:this.$DF.$GF.w,b.$DF.$GW?b.$DF.$GW.h:this.$DF.$GF.h)}else{this.$9c.x=(b.$7g+b.$HQ.x);this.$9c.y=(b.$7h+b.$HQ.y);this.$9c.w=b.$HQ.w;this.$9c.h=b.$HQ.h;if(bxg.Geometry.intersect_rect_rect(this.$9b,this.$9c)){if(b.$DF.$GJ.position){this.$9d.drawImage(b.$DF.$GJ.$9M,-b.$DF.$GJ.position.x,-b.$DF.$GJ.position.y,b.$DF.$GJ.size.w,b.$DF.$GJ.size.h,b.$7g+this.$9e,b.$7h+this.$9f,b.$DF.$GJ.size.w,b.$DF.$GJ.size.h)}else{bxg.Canvas.drawImage(this.$9d,b.$DF.$GJ.$9M,b.$7g+this.$9e,b.$7h+this.$9f,b.$DF.$GW?b.$DF.$GW.w:undefined,b.$DF.$GW?b.$DF.$GW.h:undefined,b.$DF.$GK)}}}if(b.$DF.$GJ.opacity!==undefined){this.$9d.globalAlpha=1}}else{if(b.$DF.$GD&&b.$DF.$GD.$GZ){if(b.$DF.$GD.$D9==1){this.$9c.x=(b.$7g+b.$HQ.x);this.$9c.y=(b.$7h+b.$HQ.y);this.$9c.w=b.$HQ.w;this.$9c.h=b.$HQ.h;if(b.$DF.$GW){if(bxg.Geometry.intersect_rect_rect(this.$9b,this.$9c)){b.$DF.$GD.$D8=b.$DF.$GD.$D8||{};b.$DF.$GD.$D8.area=b.$DF.$GD.$D8.area||{};b.$DF.$GD.$D8.area.x=b.$7g+this.$9e;b.$DF.$GD.$D8.area.y=b.$7h+this.$9f;b.$DF.$GD.$D8.area.w=b.$HQ.w;b.$DF.$GD.$D8.area.h=b.$HQ.h;b.$DF.$GD.$GZ(this.$9d,b.$DF.$GD.$D8)}}}else{if(b.$DF.$GD.$D9==2){b.$DF.$GD.$D8=b.$DF.$GD.$D8||{};b.$DF.$GD.$D8.area=b.$DF.$GD.$D8.area||{};b.$DF.$GD.$D8.area.x=this.$9b.x;b.$DF.$GD.$D8.area.y=this.$9b.y;b.$DF.$GD.$D8.area.w=this.$9b.w;b.$DF.$GD.$D8.area.h=this.$9b.h;b.$DF.$GD.$GZ(this.$9d,b.$DF.$GD.$D8)}}}}};bxg.$EB.$HsM=function(d,c){return d.$DF.$F6-c.$DF.$F6};bxg.$EB.$EZ.prototype.$EK=function(){if(this.$8n&&!this.$8x){this.$8s=this.$8n;this.$8n=false}if(this.$8n||this.$8s||this.$8o){if(!this.$9w&&this.$GA){this.$8m.clearRect(0,0,this.$GA.width,this.$GA.height)}if(this.$8k&&this.$8s){if(this.$8x){this.$8x.$8r.clearRect(0,0,this.$8x.$A8.width,this.$8x.$A8.height);this.$8f();this.$8x.$8z=true;this.$8s=false}if(this.$8l.$HsL){this.$8l.sort(bxg.$EB.$HsM);this.$8l.$HsL=false}for(this.$9S=0;this.$9S<this.$8l.length;this.$9S++){if(this.$8l[this.$9S].$DV){this.$GV(this.$8l[this.$9S],true)}}}if(this.$8x){if(this.$8x.$8y){this.$8m.drawImage(this.$8x.$A8,-this.$8g,-this.$8j,this.$GA.width,this.$GA.height,0,0,this.$GA.width,this.$GA.height)}else{if(this.$8x.$9g){this.$8m.drawImage(this.$8x.$A8,0,0,this.$GA.width,this.$GA.height,0,0,this.$GA.width,this.$GA.height)}else{this.$8m.drawImage(this.$8x.$A8,Math.abs(this.$8x.$9h.x-this.$8g),Math.abs(this.$8x.$9h.y-this.$8j),this.$GA.width,this.$GA.height,0,0,this.$GA.width,this.$GA.height)}}}if(this.$8o){if(this.$9a.$HsL){this.$9a.sort(bxg.$EB.$HsM);this.$9a.$HsL=false}for(this.$9S=0;this.$9S<this.$9a.length;this.$9S++){if(this.$9a[this.$9S].$DV){this.$GV(this.$9a[this.$9S])}}this.$8o=false}this.$8n=false}};bxg.$EB.$EZ.prototype.$F5=function(b){var a;if(b.$DF.$D9&bxg.$7t){if(bxg.Trace.logging){for(a=0;a<this.$8l.length;a++){if(this.$8l[a]==b){bxg.Trace.log("BXG","warning","Same render sprite is already exist in layer","RD.AS");return}}}this.$8l.push(b);this.$8l.$HsL=true;this.$8s=true;this.$8k=true;if(this.$DF.$6r&bxg.$6t){if(!this.$8x){if(this.$DF.$GF.w<this.$DF.$Hr.w||this.$DF.$GF.h<this.$DF.$Hr.h){bxg.Trace.log("BXG","error","Map area size is smaller than view screen size.","RD.AS");return}this.$8x={};this.$8x.$A8=bxg.$E9.$DF.$8p.$TAG("canvas",{},{position:"absolute",left:"0px",top:"0px",zIndex:-1,display:"block",visibility:"hidden"});this.$8x.$8r=this.$8x.$A8.getContext("2d");if(this.$DF.$6r&bxg.$6u||this.$DF.$D9==bxg.$EU){this.$8x.$A8.width=this.$GA.width;this.$8x.$A8.height=this.$GA.height;this.$8x.$9g=true}else{if(this.$DF.$D9==bxg.$FI){this.$8x.$A8.width=this.$DF.$GF.w;this.$8x.$A8.height=this.$DF.$GF.h;this.$8x.$8y=true}else{if(this.$DF.$D9==bxg.$7c||this.$DF.$D9==bxg.$7d||this.$DF.$D9==bxg.$7a){this.$8x.$A8.width=this.$GA.width*bxg.$E9.$8u;this.$8x.$A8.height=this.$DF.$GF.h}else{if(this.$DF.$D9==bxg.$7e||this.$DF.$D9==bxg.$7b||this.$DF.$D9==bxg.$6z){this.$8x.$A8.width=this.$DF.$GF.w;this.$8x.$A8.height=this.$GA.height*bxg.$E9.$8u}else{if(this.$DF.$D9==bxg.$6x){this.$8x.$A8.width=this.$GA.width*bxg.$E9.$8u;this.$8x.$A8.height=this.$GA.height*bxg.$E9.$8u}}}}}this.$8x.$9h={x:0,y:0};this.$8f()}}else{if(this.$8x){if(this.$8x.$A8){this.$8x.$A8.parentNode.removeChild(this.$8x.$A8)}delete this.$8x}}}else{if(bxg.Trace.logging){for(a=0;a<this.$9a.length;a++){if(this.$9a[a]==b){bxg.Trace.log("BXG","warning","Same render sprite is already exist in layer","RD.AS");return}}}this.$9a.push(b);this.$9a.$HsL=true;this.$8o=true}b.$AP=this};bxg.$EB.$EZ.prototype.$F7=function(a){if(a.$DF.$D9&bxg.$7t){for(this.$9S=0;this.$9S<this.$8l.length;this.$9S++){if(this.$8l[this.$9S]==a){this.$8l.splice(this.$9S,1);a.$AP=null;this.$8s=true;return}}}else{for(this.$9S=0;this.$9S<this.$9a.length;this.$9S++){if(this.$9a[this.$9S]==a){this.$9a.splice(this.$9S,1);a.$AP=null;this.$8o=true;return}}}};bxg.$EB.$EZ.prototype.$HE=function(a){this.$8s=true;this.$8o=true};bxg.$EB.$EZ.prototype.$8d=function(){if(this.$8x&&this.$8x.$8y){return this.$8x.$A8}else{if(this.$HsK){return this.$GA}}return undefined};bxg.$EB.$EZ.prototype.$8e=function(){if(this.$8x.$8y){return true}else{if(this.$DF.$D9==bxg.$7e||this.$DF.$D9==bxg.$7b){if(-this.$8x.$9h.y<=-this.$8j&&-this.$8x.$9h.y+this.$8x.$A8.height>=-this.$8j+this.$GA.height){return true}}else{if(this.$DF.$D9==bxg.$7d||this.$DF.$D9==bxg.$7c){if(-this.$8x.$9h.x<=-this.$8g&&-this.$8x.$9h.x+this.$8x.$A8.width>=-this.$8g+this.$GA.width){return true}}else{if(this.$DF.$D9==bxg.$6x){if(-this.$8x.$9h.y<=-this.$8j&&-this.$8x.$9h.y+this.$8x.$A8.height>=-this.$8j+this.$GA.height){if(-this.$8x.$9h.x<=-this.$8g&&-this.$8x.$9h.x+this.$8x.$A8.width>=-this.$8g+this.$GA.width){return true}}}else{if(this.$DF.$D9==bxg.$7a){if(-this.$8x.$9h.x<=-this.$8g&&-this.$8x.$9h.x+this.$8x.$A8.width>=-this.$8g+this.$GA.width){return true}}else{if(this.$DF.$D9==bxg.$6z){if(-this.$8x.$9h.y<=-this.$8j&&-this.$8x.$9h.y+this.$8x.$A8.height>=-this.$8j+this.$GA.height){return true}}}}}}}return false};bxg.$EB.$EZ.prototype.$8f=function(){if(this.$8x.$8y){}else{if(this.$DF.$D9==bxg.$7e){this.$8x.$9h.x=0;this.$8x.$9h.y=this.$8j+this.$GA.height*(bxg.$E9.$8u-1);if(this.$8x.$9h.y>0){this.$8x.$9h.y=0}}else{if(this.$DF.$D9==bxg.$7b){this.$8x.$9h.x=0;this.$8x.$9h.y=this.$8j}else{if(this.$DF.$D9==bxg.$7d){this.$8x.$9h.x=this.$8g+this.$GA.width*(bxg.$E9.$8u-1);this.$8x.$9h.y=0;if(this.$8x.$9h.x>0){this.$8x.$9h.x=0}}else{if(this.$DF.$D9==bxg.$7c){this.$8x.$9h.x=this.$8g;this.$8x.$9h.y=0}else{if(this.$DF.$D9==bxg.$6x){this.$8x.$9h.x=this.$8g+Math.floor(this.$GA.width*(bxg.$E9.$8u-1)*0.5);this.$8x.$9h.y=this.$8j+Math.floor(this.$GA.height*(bxg.$E9.$8u-1)*0.5);if(this.$8x.$9h.x>0){this.$8x.$9h.x=0}if(this.$8x.$9h.y>0){this.$8x.$9h.y=0}}else{if(this.$DF.$D9==bxg.$7a){this.$8x.$9h.x=this.$8g+Math.floor(this.$GA.width*(bxg.$E9.$8u-1)*0.5);this.$8x.$9h.y=0;if(this.$8x.$9h.x>0){this.$8x.$9h.x=0}}else{if(this.$DF.$D9==bxg.$6z){this.$8x.$9h.x=0;this.$8x.$9h.y=this.$8j+Math.floor(this.$GA.height*(bxg.$E9.$8u-1)*0.5);if(this.$8x.$9h.y>0){this.$8x.$9h.y=0}}}}}}}}}};bxg.CMiniMap=function(a){this.$9l=a||{};this.tag=undefined};bxg.CMiniMap.prototype.create=function(){if(!bxg.world){bxg.Trace.log("BXG","error","BXG needs to be initialized before this call.","CMiniMap.create")}if(!(bxg.$9I&bxg.$E8)){bxg.Trace.log("BXG","errorRenderer","CMiniMap","CMiniMap.create")}if((!this.$9l.width&&!this.$9l.height)||!this.$9l.control){bxg.Trace.log("BXG","errorParameter","Mandatory properties are missing in CMiniMap option","CMiniMap.create");bxg.Trace.data(this.$9l)}this.tag=bxg.world.$TAG("CANVAS",{},{position:"absolute",display:"none"});this.$9m={};this.$9n={};return this};bxg.CMiniMap.prototype.render=function(){if(!this.$3K){return}if(!this.tag){bxg.Trace.log("BXG","error","BXG needs to be initialized before this call.","CMiniMap.create");return}this.$6G=false;if(!this.$9o){this.$6G=true}if(this.$9o&&(this.$9o.w!=this.$9l.control.area.w||this.$9o.h!=this.$9l.control.area.h)){this.$6G=true}if(this.$9p&&(this.$9p.w!=this.$9l.control.scrollSize.w||this.$9p.h!=this.$9l.control.scrollSize.h)){this.$6G=true}if(this.$6G){if(this.$9l.width){this.$9n.w=this.$9l.width;this.$9P=this.$9l.width/this.$9l.control.scrollSize.w;this.$9n.h=Math.floor(this.$9l.control.scrollSize.h*this.$9P)}else{this.$9n.w=Math.floor(this.$9l.control.scrollSize.w*this.$9P);this.$9P=this.$9l.height/this.$9l.control.scrollSize.h;this.$9n.h=this.$9l.height}this.$9m.w=Math.floor(this.$9l.control.area.w*this.$9P);this.$9m.h=Math.floor(this.$9l.control.area.h*this.$9P);this.tag.style.width=this.$9n.w+"px";this.tag.style.height=this.$9n.h+"px";if(this.tag.tagName=="CANVAS"){this.tag.width=this.$9n.w;this.tag.height=this.$9n.h}}this.$9q=this.$9q||this.tag.getContext("2d");this.$9q.lineWidth=1;this.$9q.clearRect(0,0,this.tag.width,this.tag.height);if(this.$9r=this.$9l.control.$EM.$8d()){if(this.$9l.map&&this.$9l.map.opacity){this.$9q.globalAlpha=this.$9l.map.opacity}this.$9q.drawImage(this.$9r,0,0,this.$9r.width,this.$9r.height,0,0,this.$9q.canvas.width,this.$9q.canvas.height);this.$9q.globalAlpha=1}else{if(this.$9l.map){if(this.$9l.map.opacity){this.$9q.globalAlpha=this.$9l.map.opacity}if(this.$9l.map.fillStyle){this.$9q.fillStyle=this.$9l.map.fillStyle;this.$9q.fillRect(0,0,this.$9q.canvas.width,this.$9q.canvas.height)}this.$9q.globalAlpha=1}}if(this.$9l.objects){for(this.$GY in this.$9l.control.$67){this.$6i=this.$9l.control.$67[this.$GY];if(this.$6i.type&&this.$9l.objects[this.$6i.type]&&this.$6i.active&&this.$6i.$3K){if(this.$9l.objects[this.$6i.type].borderStyle){this.$9q.strokeStyle=this.$9l.objects[this.$6i.type].borderStyle;if(this.$9l.objects[this.$6i.type].shape=="circle"){this.$9q.beginPath();this.$9q.arc(this.$6i.center().x*this.$9P,this.$6i.center().y*this.$9P,Math.min((this.$6i.size.w/2)*this.$9P,(this.$6i.size.h/2)*this.$9P),0,Math.PI*2,true);this.$9q.closePath();this.$9q.stroke()}else{this.$9q.strokeRect(this.$6i.position().x*this.$9P,this.$6i.position().y*this.$9P,this.$6i.size.w*this.$9P,this.$6i.size.h*this.$9P)}}}}}if(this.$9l.view){if(this.$9l.view.opacity){this.$9q.globalAlpha=this.$9l.view.opacity}if(this.$9l.view.fillStyle){this.$9q.fillStyle=this.$9l.view.fillStyle;this.$9q.fillRect(-this.$9l.control.scrollPos.x*this.$9P,-this.$9l.control.scrollPos.y*this.$9P,this.$9m.w,this.$9m.h)}if(this.$9l.view.borderStyle){this.$9q.strokeStyle=this.$9l.view.borderStyle;this.$9q.strokeRect(-this.$9l.control.scrollPos.x*this.$9P,-this.$9l.control.scrollPos.y*this.$9P,this.$9m.w,this.$9m.h)}this.$9q.globalAlpha=1}this.$9o=this.$9o||{};this.$9o.w=this.$9l.control.area.w;this.$9o.h=this.$9l.control.area.h;this.$9p=this.$9p||{};this.$9p.w=this.$9l.control.scrollSize.w;this.$9p.h=this.$9l.control.scrollSize.h};bxg.CMiniMap.prototype.show=function(){if(this.tag){this.$3K=true;this.tag.style.display="block"}};bxg.CMiniMap.prototype.hide=function(){if(this.tag){this.$3K=false;this.tag.style.display="none"}};
"Release date: 09/19/2012 17:53:54"